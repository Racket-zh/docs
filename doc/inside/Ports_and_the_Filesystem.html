<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>15&nbsp;Ports and the Filesystem</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Inside:<span class="mywbr"> &nbsp;</span> Racket C API</a></td></tr></table></div><div class="tocviewsublistonly" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="overview.html" class="tocviewlink" data-pltdoc="x">Overview</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="embedding.html" class="tocviewlink" data-pltdoc="x">Embedding into a Program</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="Writing_Racket_Extensions.html" class="tocviewlink" data-pltdoc="x">Writing Racket Extensions</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="im_values_types.html" class="tocviewlink" data-pltdoc="x">Values and Types</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="im_memoryalloc.html" class="tocviewlink" data-pltdoc="x">Memory Allocation</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="im_env.html" class="tocviewlink" data-pltdoc="x">Namespaces and Modules</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="Procedures.html" class="tocviewlink" data-pltdoc="x">Procedures</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="Evaluation.html" class="tocviewlink" data-pltdoc="x">Evaluation</a></td></tr><tr><td align="right">9&nbsp;</td><td><a href="exceptions.html" class="tocviewlink" data-pltdoc="x">Exceptions and Escape Continuations</a></td></tr><tr><td align="right">10&nbsp;</td><td><a href="threads.html" class="tocviewlink" data-pltdoc="x">Threads</a></td></tr><tr><td align="right">11&nbsp;</td><td><a href="config.html" class="tocviewlink" data-pltdoc="x">Parameterizations</a></td></tr><tr><td align="right">12&nbsp;</td><td><a href="contmarks.html" class="tocviewlink" data-pltdoc="x">Continuation Marks</a></td></tr><tr><td align="right">13&nbsp;</td><td><a href="im_encodings.html" class="tocviewlink" data-pltdoc="x">String Encodings</a></td></tr><tr><td align="right">14&nbsp;</td><td><a href="Bignums__Rationals__and_Complex_Numbers.html" class="tocviewlink" data-pltdoc="x">Bignums, Rationals, and Complex Numbers</a></td></tr><tr><td align="right">15&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Ports and the Filesystem</a></td></tr><tr><td align="right">16&nbsp;</td><td><a href="Structures.html" class="tocviewlink" data-pltdoc="x">Structures</a></td></tr><tr><td align="right">17&nbsp;</td><td><a href="security.html" class="tocviewlink" data-pltdoc="x">Security Guards</a></td></tr><tr><td align="right">18&nbsp;</td><td><a href="Custodians.html" class="tocviewlink" data-pltdoc="x">Custodians</a></td></tr><tr><td align="right">19&nbsp;</td><td><a href="Subprocesses.html" class="tocviewlink" data-pltdoc="x">Subprocesses</a></td></tr><tr><td align="right">20&nbsp;</td><td><a href="Miscellaneous_Utilities.html" class="tocviewlink" data-pltdoc="x">Miscellaneous Utilities</a></td></tr><tr><td align="right"></td><td><a href="doc-index.html" class="tocviewlink" data-pltdoc="x">Index</a></td></tr></table></div></div></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="…搜索手册…" title="输入搜索字符串以搜索手册" onkeypress="return DoSearchKey(event, this, &quot;7.0.0.18&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;…搜索手册…&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;…搜索手册…&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="上至文档的顶层" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.0.0.18&quot;);">&#39030;&#23618;</a></span><span class="navright">&nbsp;&nbsp;<a href="Bignums__Rationals__and_Complex_Numbers.html" title="后退至&quot;14 Bignums, Rationals, and Complex Numbers&quot;" data-pltdoc="x">&larr; &#21069;&#19968;&#39029;</a>&nbsp;&nbsp;<a href="index.html" title="上至&quot;Inside: Racket C API&quot;" data-pltdoc="x">&#19978;&#19968;&#23618;</a>&nbsp;&nbsp;<a href="Structures.html" title="前进至&quot;16 Structures&quot;" data-pltdoc="x">&#21518;&#19968;&#39029; &rarr;</a></span>&nbsp;</div><h3 x-source-module="(lib &quot;scribblings/inside/inside.scrbl&quot;)" x-source-pkg="racket-doc" x-part-tag="&quot;Ports_and_the_Filesystem&quot;">15<tt>&nbsp;</tt><a name="(part._.Ports_and_the_.Filesystem)"></a>Ports and the Filesystem</h3><p>Ports are represented as Racket values with the types
<a href="im_values_types.html#%28cpp._scheme_input_port_type%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_input_port_type</span></a> and <a href="im_values_types.html#%28cpp._scheme_output_port_type%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_output_port_type</span></a>.  The
function <a href="#%28cpp._scheme_read%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_read</span></a> takes an input port value and returns the
next S-expression from the port.  The function <a href="#%28cpp._scheme_write%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_write</span></a>
takes an output port and a value and writes the value to the
port. Other standard low-level port functions are also provided, such
as <a href="#%28cpp._scheme_getc%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_getc</span></a>.</p><p>File ports are created with <a href="#%28cpp._scheme_make_file_input_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_file_input_port</span></a> and
<a href="#%28cpp._scheme_make_file_output_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_file_output_port</span></a>; these functions take a <span class="stt">FILE
*</span> file pointer and return a Scheme port. Strings are read or written
with <a href="#%28cpp._scheme_make_byte_string_input_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_byte_string_input_port</span></a>, which takes a
nul-terminated byte string, and
<a href="#%28cpp._scheme_make_byte_string_output_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_byte_string_output_port</span></a>, which takes no arguments.
The contents of a string output port are obtained with
<a href="#%28cpp._scheme_get_byte_string_output%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_get_byte_string_output</span></a>.</p><p>Custom ports, with arbitrary read/write handlers, are created with
<a href="#%28cpp._scheme_make_input_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_input_port</span></a> and <a href="#%28cpp._scheme_make_output_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_output_port</span></a>.</p><p>When opening a file for any reason using a name provided from Racket,
use <a href="#%28cpp._scheme_expand_filename%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_expand_filename</span></a> to normalize the filename and
resolve relative paths.</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Scheme_Object*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_read)"></a><a name="(idx._(gentag._485._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_read%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_read</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara"><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Reading.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._read%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">read</a></span>s the next S-expression from the given input port.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_write)"></a><a name="(idx._(gentag._486._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_write%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_write</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">obj</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara"><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._write%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">write</a></span>s the Scheme value <span style="font-family: 楷体">obj</span> to the given output port.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_write_w_max)"></a><a name="(idx._(gentag._487._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_write_w_max%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_write_w_max</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">obj</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">n</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Like <a href="#%28cpp._scheme_write%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_write</span></a>, but the printing is truncated to <span style="font-family: 楷体">n</span> bytes.
(If printing is truncated, the last bytes are printed as &ldquo;.&rdquo;.)</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_display)"></a><a name="(idx._(gentag._488._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_display%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_display</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">obj</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara"><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._display%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">display</a></span>s the Racket value <span style="font-family: 楷体">obj</span> to the given output
port.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_display_w_max)"></a><a name="(idx._(gentag._489._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_display_w_max%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_display_w_max</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">obj</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">n</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Like <a href="#%28cpp._scheme_display%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_display</span></a>, but the printing is truncated to <span style="font-family: 楷体">n</span> bytes.
(If printing is truncated, the last three bytes are printed as &ldquo;.&rdquo;.)</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_write_byte_string)"></a><a name="(idx._(gentag._490._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_write_byte_string%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_write_byte_string</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">str</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">len</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Writes <span style="font-family: 楷体">len</span> bytes of <span style="font-family: 楷体">str</span> to the given output port.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_write_char_string)"></a><a name="(idx._(gentag._491._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_write_char_string%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_write_char_string</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">mzchar*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">str</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">len</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Writes <span style="font-family: 楷体">len</span> characters of <span style="font-family: 楷体">str</span> to the given output port.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">intptr_t</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_put_byte_string)"></a><a name="(idx._(gentag._492._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_put_byte_string%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_put_byte_string</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">const char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">who</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">str</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">d</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">len</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">rarely_block</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Writes <span style="font-family: 楷体">len</span> bytes of <span style="font-family: 楷体">str</span>, starting with the <span style="font-family: 楷体">d</span>th
character. Bytes are written to the given output port, and errors are
reported as from <span style="font-family: 楷体">who</span>.</div></p><p>If <span style="font-family: 楷体">rarely_block</span> is <span class="stt">0</span>, the write blocks until all <span style="font-family: 楷体">len</span>
bytes are written, possibly to an internal buffer. If
<span style="font-family: 楷体">rarely_block</span> is <span class="stt">2</span>, the write never blocks, and written
bytes are not buffered. If <span style="font-family: 楷体">rarely_block</span> is <span class="stt">1</span>, the write
blocks only until at least one byte is written (without buffering) or
until part of an internal buffer is flushed.</p><p>Supplying <span class="stt">0</span> for <span style="font-family: 楷体">len</span> corresponds to a buffer-flush
request. If <span style="font-family: 楷体">rarely_block</span> is <span class="stt">2</span>, the flush request is
non-blocking, and if <span style="font-family: 楷体">rarely_block</span> is <span class="stt">0</span>, it is blocking.
(A <span style="font-family: 楷体">rarely_block</span> of <span class="stt">1</span> is the same as <span class="stt">0</span> in this case.)</p><p>The result is <span class="stt">-1</span> if no bytes are written from <span style="font-family: 楷体">str</span> and
unflushed bytes remain in the internal buffer. Otherwise, the return
value is the number of written characters.</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">intptr_t</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_put_char_string)"></a><a name="(idx._(gentag._493._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_put_char_string%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_put_char_string</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">const char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">who</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">str</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">d</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">len</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Like <a href="#%28cpp._scheme_put_byte_string%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_put_byte_string</span></a>, but for a <span class="stt">mzchar</span> string, and
without the non-blocking option.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">char*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_write_to_string)"></a><a name="(idx._(gentag._494._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_write_to_string%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_write_to_string</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">obj</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">len</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Prints the Racket value <span style="font-family: 楷体">obj</span> using <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._write%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">write</a></span> to a newly
allocated string. If <span style="font-family: 楷体">len</span> is not <span class="stt">NULL</span>, <span class="stt">*</span><span style="font-family: 楷体">len</span> is
set to the length of the bytes string.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_write_to_string_w_max)"></a><a name="(idx._(gentag._495._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_write_to_string_w_max%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_write_to_string_w_max</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">obj</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">len</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">n</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Like <a href="#%28cpp._scheme_write_to_string%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_write_to_string</span></a>, but the string is truncated to
<span style="font-family: 楷体">n</span> bytes.  (If the string is truncated, the last three bytes are
&ldquo;.&rdquo;.)</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">char*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_display_to_string)"></a><a name="(idx._(gentag._496._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_display_to_string%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_display_to_string</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">obj</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">len</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Prints the Racket value <span style="font-family: 楷体">obj</span> using <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._display%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">display</a></span> to a newly
allocated string. If <span style="font-family: 楷体">len</span> is not <span class="stt">NULL</span>, <span class="stt">*</span><span style="font-family: 楷体">len</span> is
set to the length of the string.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_display_to_string_w_max)"></a><a name="(idx._(gentag._497._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_display_to_string_w_max%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_display_to_string_w_max</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">obj</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">len</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">n</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Like <a href="#%28cpp._scheme_display_to_string%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_display_to_string</span></a>, but the string is truncated to
<span style="font-family: 楷体">n</span> bytes.  (If the string is truncated, the last three bytes are
&ldquo;.&rdquo;.)</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_debug_print)"></a><a name="(idx._(gentag._498._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_debug_print%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_debug_print</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">obj</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Prints the Racket value <span style="font-family: 楷体">obj</span> using <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._write%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">write</a></span> to the main
thread&rsquo;s output port.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_flush_output)"></a><a name="(idx._(gentag._499._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_flush_output%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_flush_output</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">If <span style="font-family: 楷体">port</span> is a file port, a buffered data is written to the file.
Otherwise, there is no effect. <span style="font-family: 楷体">port</span> must be an output port.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">int</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_get_byte)"></a><a name="(idx._(gentag._500._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_get_byte%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_get_byte</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Get the next byte from the given input port. The result can be <span class="stt">EOF</span>.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">int</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_getc)"></a><a name="(idx._(gentag._501._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_getc%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_getc</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Get the next character from the given input port (by decoding bytes as UTF-8).
  The result can be <span class="stt">EOF</span>.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">int</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_peek_byte)"></a><a name="(idx._(gentag._502._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_peek_byte%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_peek_byte</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Peeks the next byte from the given input port.  The result can be <span class="stt">EOF</span>.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">int</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_peekc)"></a><a name="(idx._(gentag._503._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_peekc%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_peekc</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Peeks the next character from the given input port (by decoding bytes as UTF-8).
  The result can be <span class="stt">EOF</span>.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">int</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_peek_byte_skip)"></a><a name="(idx._(gentag._504._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_peek_byte_skip%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_peek_byte_skip</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">skip</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Like <a href="#%28cpp._scheme_peek_byte%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_peek_byte</span></a>, but with a skip count.  The result can be <span class="stt">EOF</span>.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">int</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_peekc_skip)"></a><a name="(idx._(gentag._505._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_peekc_skip%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_peekc_skip</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">skip</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Like <a href="#%28cpp._scheme_peekc%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_peekc</span></a>, but with a skip count.  The result can be <span class="stt">EOF</span>.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">intptr_t</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_get_byte_string)"></a><a name="(idx._(gentag._506._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_get_byte_string%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_get_byte_string</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">const char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">who</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">buffer</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">offset</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">size</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">only_avail</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">peek</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">peek_skip</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Gets multiple bytes at once from a port, reporting errors with the
name <span style="font-family: 楷体">who</span>. The <span style="font-family: 楷体">size</span> argument indicates the number of
requested bytes, to be put into the <span style="font-family: 楷体">buffer</span> array starting at
<span style="font-family: 楷体">offset</span>.  The return value is the number of bytes actually read,
or <span class="stt">EOF</span> if an end-of-file is encountered without reading any
bytes.</div></p><p>If <span style="font-family: 楷体">only_avail</span> is <span class="stt">0</span>, then the function blocks until
<span style="font-family: 楷体">size</span> bytes are read or an end-of-file is reached. If
<span style="font-family: 楷体">only_avail</span> is <span class="stt">1</span>, the function blocks only until at least
one byte is read. If <span style="font-family: 楷体">only_avail</span> is <span class="stt">2</span>, the function never
blocks. If <span style="font-family: 楷体">only_avail</span> is <span class="stt">-1</span>, the function blocks only
until at least one byte is read but also allows breaks (with the
guarantee that bytes are read or a break is raised, but not both).</p><p>If <span style="font-family: 楷体">peek</span> is non-zero, then the port is peeked instead of
read. The <span style="font-family: 楷体">peek_skip</span> argument indicates a portion of the input
stream to skip as a non-negative, exact integer (fixnum or bignum). In
this case, an <span style="font-family: 楷体">only_avail</span> value of <span class="stt">1</span> means to continue the
skip until at least one byte can be returned, even if it means
multiple blocking reads to skip bytes.</p><p>If <span style="font-family: 楷体">peek</span> is zero, then <span style="font-family: 楷体">peek_skip</span> should be either
<span class="stt">NULL</span> (which means zero) or the fixnum zero.</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">intptr_t</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_get_char_string)"></a><a name="(idx._(gentag._507._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_get_char_string%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_get_char_string</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">const char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">who</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">buffer</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">offset</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">size</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">peek</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">peek_skip</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Like <a href="#%28cpp._scheme_get_byte_string%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_get_byte_string</span></a>, but for characters (by decoding
bytes as UTF-8), and without the non-blocking option.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">intptr_t</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_get_bytes)"></a><a name="(idx._(gentag._508._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_get_bytes%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_get_bytes</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">size</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">buffer</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">offset</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">For backward compatibility: calls <a href="#%28cpp._scheme_get_byte_string%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_get_byte_string</span></a> in
essentially the obvious way with <span style="font-family: 楷体">only_avail</span> as <span class="stt">0</span>; if
<span style="font-family: 楷体">size</span> is negative, then it reads <span style="font-family: 楷体">-size</span> bytes with
<span style="font-family: 楷体">only_avail</span> as <span class="stt">1</span>.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_ungetc)"></a><a name="(idx._(gentag._509._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_ungetc%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_ungetc</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">ch</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Puts the byte <span style="font-family: 楷体">ch</span> back as the next character to be read from the
given input port. The character need not have been read from
<span style="font-family: 楷体">port</span>, and <a href="#%28cpp._scheme_ungetc%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_ungetc</span></a> can be called to insert up to five
characters at the start of <span style="font-family: 楷体">port</span>.</div></p><p>Use <a href="#%28cpp._scheme_get_byte%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_get_byte</span></a> followed by <a href="#%28cpp._scheme_ungetc%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_ungetc</span></a> only when
your program will certainly call <a href="#%28cpp._scheme_get_byte%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_get_byte</span></a> again to
consume the byte. Otherwise, use <a href="#%28cpp._scheme_peek_byte%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_peek_byte</span></a>, because some
a port may implement peeking and getting differently.</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">int</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_byte_ready)"></a><a name="(idx._(gentag._510._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_byte_ready%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_byte_ready</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Returns 1 if a call to <a href="#%28cpp._scheme_get_byte%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_get_byte</span></a> is guaranteed not to
block for the given input port.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">int</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_char_ready)"></a><a name="(idx._(gentag._511._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_char_ready%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_char_ready</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Returns 1 if a call to <a href="#%28cpp._scheme_getc%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_getc</span></a> is guaranteed not to block
for the given input port.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_need_wakeup)"></a><a name="(idx._(gentag._512._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_need_wakeup%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_need_wakeup</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">void*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">fds</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Requests that appropriate bits are set in <span style="font-family: 楷体">fds</span> to specify which
file descriptors(s) the given input port reads from. (<span style="font-family: 楷体">fds</span> is
sortof a pointer to an <span class="stt">fd_set</span> struct; see
<a href="threads.html#%28part._blockednonmainel%29" data-pltdoc="x">Callbacks for Blocked Threads</a>.)</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">intptr_t</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_tell)"></a><a name="(idx._(gentag._513._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_tell%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_tell</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Returns the current read position of the given input port, or the
 current file position of the given output port.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">intptr_t</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_tell_line)"></a><a name="(idx._(gentag._514._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_tell_line%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_tell_line</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Returns the current read line of the given input port. If lines are
not counted, -1 is returned.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_count_lines)"></a><a name="(idx._(gentag._515._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_count_lines%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_count_lines</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Turns on line-counting for the given input port. To get accurate line
counts, call this function immediately after creating a port.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">intptr_t</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_set_file_position)"></a><a name="(idx._(gentag._516._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_set_file_position%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_set_file_position</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">pos</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Sets the file position of the given input or output port (from the
start of the file). If the port does not support position setting, an
exception is raised.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_close_input_port)"></a><a name="(idx._(gentag._517._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_close_input_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_close_input_port</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Closes the given input port.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_close_output_port)"></a><a name="(idx._(gentag._518._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_close_output_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_close_output_port</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Closes the given output port.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">int</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_get_port_file_descriptor)"></a><a name="(idx._(gentag._519._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_get_port_file_descriptor%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_get_port_file_descriptor</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">fd</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Fills <span class="stt">*</span><span style="font-family: 楷体">fd</span> with a file-descriptor value for <span style="font-family: 楷体">port</span> if
one is available (i.e., the port is a file-stream port and it is not
closed). The result is non-zero if the file-descriptor value is
available, zero otherwise. On Windows, a &ldquo;file dscriptor&rdquo; is a
file <span class="stt">HANDLE</span>.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">intptr_t</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_get_port_fd)"></a><a name="(idx._(gentag._520._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_get_port_fd%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_get_port_fd</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Like <a href="#%28cpp._scheme_get_port_file_descriptor%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_get_port_file_descriptor</span></a>, but a file
 descriptor or <span class="stt">HANDLE</span> is returned directly, and the result is
 <span class="stt">-1</span> if no file descriptor or <span class="stt">HANDLE</span> is available.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">intptr_t</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_get_port_socket)"></a><a name="(idx._(gentag._521._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_get_port_socket%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_get_port_socket</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">s</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Fills <span class="stt">*</span><span style="font-family: 楷体">s</span> with a socket value for <span style="font-family: 楷体">port</span> if one is
available (i.e., the port is a TCP port and it is not closed). The
result is non-zero if the socket value is available, zero
otherwise. On Windows, a socket value has type <span class="stt">SOCKET</span>.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Scheme_Object*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_make_port_type)"></a><a name="(idx._(gentag._522._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_make_port_type%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_port_type</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">name</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Creates a new port subtype.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td colspan="3"><p><span class="stt">Scheme_Input_Port*</span></p></td></tr><tr><td><p><a name="(cpp._scheme_make_input_port)"></a><a name="(idx._(gentag._523._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_make_input_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_input_port</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">subtype</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">void*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">data</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">name</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Get_String_Fun</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">get_bytes_fun</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Peek_String_Fun</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">peek_bytes_fun</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Progress_Evt_Fun</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">progress_evt_fun</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Peeked_Read_Fun</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">peeked_read_fun</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_In_Ready_Fun</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">char_ready_fun</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Close_Input_Fun</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">close_fun</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Need_Wakeup_Input_Fun</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">need_wakeup_fun</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">must_close</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Creates a new input port with arbitrary control functions. The
<span style="font-family: 楷体">subtype</span> is an arbitrary value to distinguish the port&rsquo;s class.
The pointer <span style="font-family: 楷体">data</span> will be installed as the port&rsquo;s user data,
which can be extracted/set with the <a href="im_values_types.html#%28cpp._.S.C.H.E.M.E_.I.N.P.O.R.T_.V.A.L%29" class="RktStxLink" data-pltdoc="x"><span class="stt">SCHEME_INPORT_VAL</span></a> macro.
The <span style="font-family: 楷体">name</span> object is used as the port&rsquo;s name (for
<span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=inspectors.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._object-name%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">object-name</a></span> and as the default source name for
<span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Reading.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._read-syntax%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">read-syntax</a></span>).</div></p><p>If <span style="font-family: 楷体">must_close</span> is non-zero, the new port will be registered with
the current custodian, and <span style="font-family: 楷体">close_fun</span> is guaranteed to be called
before the port is garbage-collected.</p><p>Although the return type of <a href="#%28cpp._scheme_make_input_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_input_port</span></a> is
<span class="stt">Scheme_Input_Port*</span>, it can be cast into a <span class="stt">Scheme_Object*</span>.</p><p>The functions are as follows.</p><blockquote class="leftindent"><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">intptr_t</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span style="font-family: 楷体">get_bytes_fun</span></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Input_Port*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">buffer</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">offset</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">size</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">nonblock</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">unless</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Reads bytes into <span style="font-family: 楷体">buffer</span>, starting from <span style="font-family: 楷体">offset</span>, up to
<span style="font-family: 楷体">size</span> bytes (i.e., <span style="font-family: 楷体">buffer</span> is at least
<span style="font-family: 楷体">offset</span> plus <span style="font-family: 楷体">size</span> long). If <span style="font-family: 楷体">nonblock</span> is <span class="stt">0</span>,
then the function can block indefinitely, but it should return
when at least one byte of data is available. If <span style="font-family: 楷体">nonblock</span> is
<span class="stt">1</span>, the function should never block. If <span style="font-family: 楷体">nonblock</span> is
<span class="stt">2</span>, a port in unbuffered mode should return only bytes
previously forced to be buffered; other ports should treat a
<span style="font-family: 楷体">nonblock</span> of <span class="stt">2</span> like <span class="stt">1</span>. If <span style="font-family: 楷体">nonblock</span> is
<span class="stt">-1</span>, the function can block, but should enable breaks while
blocking. The function should return <span class="stt">0</span> if no bytes are ready
in non-blocking mode. It should return <span class="stt">EOF</span> if an end-of-file
is reached (and no bytes were read into <span style="font-family: 楷体">buffer</span>). Otherwise,
the function should return the number of read bytes. The function
can raise an exception to report an error.</div></p><p>The <span style="font-family: 楷体">unless</span> argument will be non-<span class="stt">NULL</span> only when
<span style="font-family: 楷体">nonblocking</span> is non-zero (except as noted below), and only if
the port supports progress events. If <span style="font-family: 楷体">unless</span> is
non-<span class="stt">NULL</span> and <span class="stt">SCHEME_CDR(</span><span style="font-family: 楷体">unless</span><span class="stt">)</span> is
non-<span class="stt">NULL</span>, the latter is a progress event specific to the
port. The <span style="font-family: 楷体">get_bytes_fun</span> function should return
<span class="stt">SCHEME_UNLESS_READY</span> instead of reading bytes if the event
in <span style="font-family: 楷体">unless</span> becomes ready before bytes can be read. In
particular, <span style="font-family: 楷体">get_bytes_fun</span> should check the event in
<span style="font-family: 楷体">unless</span> before taking any action, and it should check the
event in <span style="font-family: 楷体">unless</span> after any operation that may allow Racket
thread swaps. If the read must block, then it should unblock if
the event in <span style="font-family: 楷体">unless</span> becomes ready.</p><p>If <span class="stt">scheme_progress_evt_via_get</span> is used for
<span style="font-family: 楷体">progress_evt_fun</span>, then <span style="font-family: 楷体">unless</span> can be non-<span class="stt">NULL</span>
even when <span style="font-family: 楷体">nonblocking</span> is <span class="stt">0</span>. In all modes,
<span style="font-family: 楷体">get_bytes_fun</span> must call <span class="stt">scheme_unless_ready</span> to check
<span style="font-family: 楷体">unless_evt</span>.  Furthermore, after any potentially
thread-swapping operation, <span style="font-family: 楷体">get_bytes_fun</span> must call
<span class="stt">scheme_wait_input_allowed</span>, because another thread may be
attempting to commit, and <span style="font-family: 楷体">unless_evt</span> must be checked after
<span class="stt">scheme_wait_input_allowed</span> returns. To block, the port should
use <a href="threads.html#%28cpp._scheme_block_until_unless%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_block_until_unless</span></a> instead of
<a href="threads.html#%28cpp._scheme_block_until%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_block_until</span></a>.  Finally, in blocking mode,
<span style="font-family: 楷体">get_bytes_fun</span> must return after immediately reading data,
without allowing a Racket thread swap.</p></blockquote><blockquote class="leftindent"><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">intptr_t</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span style="font-family: 楷体">peek_bytes_fun</span></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Input_Port*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">buffer</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">offset</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">size</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">skip</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">nonblock</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">unless_evt</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Can be <span class="stt">NULL</span> to use a default implementation of peeking that
uses <span style="font-family: 楷体">get_bytes_fun</span>. Otherwise, the protocol is the same as
for <span style="font-family: 楷体">get_bytes_fun</span>, except that an extra <span style="font-family: 楷体">skip</span> argument
indicates the number of input elements to skip (but <span style="font-family: 楷体">skip</span>
does not apply to <span style="font-family: 楷体">buffer</span>). The <span style="font-family: 楷体">skip</span> value will be a
non-negative exact integer, either a fixnum or a bignum.</div></p></blockquote><blockquote class="leftindent"><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Scheme_Object*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span style="font-family: 楷体">progress_evt_fun</span></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Input_Port*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Called to obtain a progress event for the port, such as for
<span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Byte_and_String_Input.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._port-progress-evt%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">port-progress-evt</a></span>. This function can be <span class="stt">NULL</span> if the
port does not support progress events. Use
<span class="stt">scheme_progress_evt_via_get</span> to obtain a default implementation, in
which case <span style="font-family: 楷体">peeked_read_fun</span> should be
<span class="stt">scheme_peeked_read_via_get</span>, and <span style="font-family: 楷体">get_bytes_fun</span> and
<span style="font-family: 楷体">peek_bytes_fun</span> should handle <span style="font-family: 楷体">unless</span> as described
above.</div></p></blockquote><blockquote class="leftindent"><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">int</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span style="font-family: 楷体">peeked_read_fun</span></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Input_Port*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">amount</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">unless_evt</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">target_ch</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Called to commit previously peeked bytes, just like the sixth
argument to <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=customport.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._make-input-port%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">make-input-port</a></span>. Use
<span class="stt">scheme_peeked_read_via_get</span> for the default implementation of
commits when <span style="font-family: 楷体">progress_evt_fun</span> is
<span class="stt">scheme_progress_evt_via_get</span>.</div></p><p>The <span style="font-family: 楷体">peeked_read_fun</span> function must call
<a href="#%28cpp._scheme_port_count_lines%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_port_count_lines</span></a> on a successful commit to adjust the
port&rsquo;s position. If line counting is enabled for the port and if
line counting uses the default implementation,
<span style="font-family: 楷体">peeked_read_fun</span> should supply a non-<span class="stt">NULL</span> byte-string
argument to <a href="#%28cpp._scheme_port_count_lines%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_port_count_lines</span></a>, so that character and
line counts can be tracked correctly.</p></blockquote><blockquote class="leftindent"><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">int</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span style="font-family: 楷体">char_ready_fun</span></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Input_Port*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Returns <span class="stt">1</span> when a non-blocking <span style="font-family: 楷体">get_bytes_fun</span> will
return bytes or an <span class="stt">EOF</span>.</div></p></blockquote><blockquote class="leftindent"><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span style="font-family: 楷体">close_fun</span></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Input_Port*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Called to close the port. The port is not considered closed until
the function returns.</div></p></blockquote><blockquote class="leftindent"><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span style="font-family: 楷体">need_wakeup_fun</span></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Input_Port*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">void*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">fds</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Called when the port is blocked on a read; <span style="font-family: 楷体">need_wakeup_fun</span>
should set appropriate bits in <span style="font-family: 楷体">fds</span> to specify which file
descriptor(s) it is blocked on. The <span style="font-family: 楷体">fds</span> argument is
conceptually an array of three <span class="stt">fd_set</span> structs (one for
read, one for write, one for exceptions), but manipulate this
array using <a href="threads.html#%28cpp._scheme_get_fdset%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_get_fdset</span></a> to get a particular element of
the array, and use <span class="stt">MZ_FD_XXX</span> instead of <span class="stt">FD_XXX</span> to
manipulate a single &ldquo;<span class="stt">fd_set</span>&rdquo;. On Windows, the first
&ldquo;<span class="stt">fd_set</span>&rdquo; can also contain OS-level semaphores or other
handles via <a href="threads.html#%28cpp._scheme_add_fd_handle%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_add_fd_handle</span></a>.</div></p></blockquote><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td colspan="3"><p><span class="stt">Scheme_Output_Port*</span></p></td></tr><tr><td><p><a name="(cpp._scheme_make_output_port)"></a><a name="(idx._(gentag._524._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_make_output_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_output_port</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">subtype</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">void*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">data</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">name</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Write_String_Evt_Fun</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">write_bytes_evt_fun</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Write_String_Fun</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">write_bytes_fun</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Out_Ready_Fun</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">char_ready_fun</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Close_Output_Fun</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">close_fun</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Need_Wakeup_Output_Fun</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">need_wakeup_fun</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Write_Special_Evt_Fun</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">write_special_evt_fun</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Write_Special_Fun</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">write_special_fun</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">must_close</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Creates a new output port with arbitrary control functions.  The
<span style="font-family: 楷体">subtype</span> is an arbitrary value to distinguish the port&rsquo;s class.
The pointer <span style="font-family: 楷体">data</span> will be installed as the port&rsquo;s user data,
which can be extracted/set with the <a href="im_values_types.html#%28cpp._.S.C.H.E.M.E_.O.U.T.P.O.R.T_.V.A.L%29" class="RktStxLink" data-pltdoc="x"><span class="stt">SCHEME_OUTPORT_VAL</span></a>
macro. The <span style="font-family: 楷体">name</span> object is used as the port&rsquo;s name.</div></p><p>If <span style="font-family: 楷体">must_close</span> is non-zero, the new port will be registered with
the current custodian, and <span style="font-family: 楷体">close_fun</span> is guaranteed to be called
before the port is garbage-collected.</p><p>Although the return type of <a href="#%28cpp._scheme_make_output_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_output_port</span></a> is
<span class="stt">Scheme_Output_Port*</span>, it can be cast into a
<span class="stt">Scheme_Object*</span>.</p><p>The functions are as follows.</p><blockquote class="leftindent"><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">intptr_t</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span style="font-family: 楷体">write_bytes_evt_fun</span></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Output_Port*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">const char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">buffer</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">offset</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">size</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Returns an event that writes up to <span style="font-family: 楷体">size</span> bytes atomically
when event is chosen in a synchronization. Supply <span class="stt">NULL</span> if
bytes cannot be written atomically, or supply
<span class="stt">scheme_write_evt_via_write</span> to use the default
implementation in terms of <span class="stt">write_bytes_fun</span> (with
<span style="font-family: 楷体">rarely_block</span> as <span class="stt">2</span>).</div></p></blockquote><blockquote class="leftindent"><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">intptr_t</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span style="font-family: 楷体">write_bytes_fun</span></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Output_Port*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">const char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">buffer</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">offset</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">size</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">rarely_block</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">enable_break</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Write bytes from <span style="font-family: 楷体">buffer</span>, starting from <span style="font-family: 楷体">offset</span>, up to
<span style="font-family: 楷体">size</span> bytes (i.e., <span style="font-family: 楷体">buffer</span> is at least
<span style="font-family: 楷体">offset</span> plus <span style="font-family: 楷体">size</span> long). If <span style="font-family: 楷体">rarely_block</span> is <span class="stt">0</span>,
then the function can block indefinitely, and it can buffer
output. If <span style="font-family: 楷体">rarely_block</span> is <span class="stt">2</span>, the function should
never block, and it should not buffer output. If
<span style="font-family: 楷体">rarely_block</span> is <span class="stt">1</span>, the function should not buffer
data, and it should block only until writing at least one byte,
either from <span style="font-family: 楷体">buffer</span> or an internal buffer. The function
should return the number of bytes from <span style="font-family: 楷体">buffer</span> that were
written; when <span style="font-family: 楷体">rarely_block</span> is non-zero and bytes remain in
an internal buffer, it should return <span class="stt">-1</span>. The <span style="font-family: 楷体">size</span>
argument can be <span class="stt">0</span> when <span style="font-family: 楷体">rarely_block</span> is <span class="stt">0</span> for a
blocking flush, and it can be <span class="stt">0</span> if <span style="font-family: 楷体">rarely_block</span> is
<span class="stt">2</span> for a non-blocking flush.  If <span style="font-family: 楷体">enable_break</span> is true,
then it should enable breaks while blocking. The function can
raise an exception to report an error.</div></p></blockquote><blockquote class="leftindent"><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">int</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span style="font-family: 楷体">char_ready_fun</span></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Output_Port*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Returns <span class="stt">1</span> when a non-blocking <span style="font-family: 楷体">write_bytes_fun</span> will
write at least one byte or flush at least one byte from
the port&rsquo;s internal buffer.</div></p></blockquote><blockquote class="leftindent"><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span style="font-family: 楷体">close_fun</span></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Output_Port*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Called to close the port. The port is not considered closed until
the function returns. This function is allowed to block (usually
to flush a buffer) unless
<a href="#%28cpp._scheme_close_should_force_port_closed%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_close_should_force_port_closed</span></a> returns a non-zero
result, in which case the function must return without blocking.</div></p></blockquote><blockquote class="leftindent"><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span style="font-family: 楷体">need_wakeup_fun</span></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Output_Port*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">void*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">fds</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Called when the port is blocked on a write; <span style="font-family: 楷体">need_wakeup_fun</span>
should set appropriate bits in <span style="font-family: 楷体">fds</span> to specify which file
descriptor(s) it is blocked on. The <span style="font-family: 楷体">fds</span> argument is
conceptually an array of three <span class="stt">fd_set</span> structs (one for
read, one for write, one for exceptions), but manipulate this
array using <a href="threads.html#%28cpp._scheme_get_fdset%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_get_fdset</span></a> to get a particular element of
the array, and use <span class="stt">MZ_FD_XXX</span> instead of <span class="stt">FD_XXX</span> to
manipulate a single &ldquo;<span class="stt">fd_set</span>&rdquo;. On Windows, the first
&ldquo;<span class="stt">fd_set</span>&rdquo; can also contain OS-level semaphores or other
handles via <a href="threads.html#%28cpp._scheme_add_fd_handle%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_add_fd_handle</span></a>.</div></p></blockquote><blockquote class="leftindent"><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">int</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span style="font-family: 楷体">write_special_evt_fun</span></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Output_Port*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">v</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Returns an event that writes <span style="font-family: 楷体">v</span> atomically when event is
chosen in a synchronization. Supply <span class="stt">NULL</span> if specials cannot
be written atomically (or at all), or supply
<span class="stt">scheme_write_special_evt_via_write_special</span> to use the
default implementation in terms of <span class="stt">write_special_fun</span> (with
<span style="font-family: 楷体">non_block</span> as <span class="stt">1</span>).</div></p></blockquote><blockquote class="leftindent"><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">int</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span style="font-family: 楷体">write_special_fun</span></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Output_Port*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">v</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">non_block</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Called to write the special value <span style="font-family: 楷体">v</span> for
<span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Byte_and_String_Output.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._write-special%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">write-special</a></span> (when <span style="font-family: 楷体">non_block</span> is <span class="stt">0</span>) or
<span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Byte_and_String_Output.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._write-special-avail%252A%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">write-special-avail*</a></span> (when <span style="font-family: 楷体">non_block</span> is
<span class="stt">1</span>). If <span class="stt">NULL</span> is supplied instead of a function pointer,
then <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Byte_and_String_Output.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._write-special%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">write-special</a></span> and <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Byte_and_String_Output.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._write-special-avail%252A%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">write-special-avail*</a></span>
produce an error for this port.</div></p></blockquote><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td colspan="3"><p><span class="stt">void</span></p></td></tr><tr><td><p><a name="(cpp._scheme_set_port_location_fun)"></a><a name="(idx._(gentag._525._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_set_port_location_fun%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_set_port_location_fun</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Port*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Location_Fun</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">location_fun</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Sets the implementation of <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=linecol.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._port-next-location%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">port-next-location</a></span> for <span style="font-family: 楷体">port</span>,
which is used when line counting is enabled for <span style="font-family: 楷体">port</span>.</div></p><blockquote class="leftindent"><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Scheme_Object*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span style="font-family: 楷体">location_fun</span></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Port*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Returns three values: a positive exact integer or <span class="RktVal">#f</span> for a line number,
a non-negative exact integer or <span class="RktVal">#f</span> for a column (which must be <span class="RktVal">#f</span>
if and only if the line number is <span class="RktVal">#f</span>), and
a positive exact integer or <span class="RktVal">#f</span> for a character position.</div></p></blockquote><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td colspan="3"><p><span class="stt">void</span></p></td></tr><tr><td><p><a name="(cpp._scheme_set_port_count_lines_fun)"></a><a name="(idx._(gentag._526._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_set_port_count_lines_fun%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_set_port_count_lines_fun</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Port*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Count_Lines_Fun</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">count_lines_fun</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Installs a notification callback that is invoked if line counting is subsequently
enabled for <span style="font-family: 楷体">port</span>.</div></p><blockquote class="leftindent"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span style="font-family: 楷体">count_lines_fun</span></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Port*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></blockquote><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_port_count_lines)"></a><a name="(idx._(gentag._527._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_port_count_lines%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_port_count_lines</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Port*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">const char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">buffer</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">offset</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">got</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Updates the position of <span style="font-family: 楷体">port</span> as reported by
<span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=port-buffers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._file-position%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">file-position</a></span> as well as the locations reported by
<span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=linecol.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._port-next-location%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">port-next-location</a></span> when the default implement of character
and line counting is used. This function is intended for use by a
peek-commit implementation in an input port.</div></p><p>The <span style="font-family: 楷体">got</span> argument indicates the number of bytes read from or
written to <span style="font-family: 楷体">port</span>. The <span style="font-family: 楷体">buffer</span> argument is used only when
line counting is enabled, and it represents specific bytes read or
written for the purposes of character and line coutning. The
<span style="font-family: 楷体">buffer</span> argument can be <span class="stt">NULL</span>, in which case <span style="font-family: 楷体">got</span>
non-newline characters are assumed. The <span style="font-family: 楷体">offset</span> argument
indicates a starting offset into <span style="font-family: 楷体">buffer</span>, so <span class="RktVal">"buffer"</span> must
be at least <span style="font-family: 楷体">offset</span> plus <span style="font-family: 楷体">got</span> bytes long.</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Scheme_Object*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_make_file_input_port)"></a><a name="(idx._(gentag._528._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_make_file_input_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_file_input_port</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">FILE*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">fp</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Creates a Scheme input file port from an ANSI C file pointer. The file
 must never block on reads.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Scheme_Object*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_open_input_file)"></a><a name="(idx._(gentag._529._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_open_input_file%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_open_input_file</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">const char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">filename</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">const char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">who</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Opens <span style="font-family: 楷体">filename</span> for reading. If an exception is raised, the
 exception message uses <span style="font-family: 楷体">who</span> as the name of procedure that raised
 the exception.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td colspan="3"><p><span class="stt">Scheme_Object*</span></p></td></tr><tr><td><p><a name="(cpp._scheme_make_named_file_input_port)"></a><a name="(idx._(gentag._530._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_make_named_file_input_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_named_file_input_port</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">FILE*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">fp</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">name</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Creates a Racket input file port from an ANSI C file pointer. The file
 must never block on reads. The <span style="font-family: 楷体">name</span> argument is used as the
 port&rsquo;s name.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Scheme_Object*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_open_output_file)"></a><a name="(idx._(gentag._531._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_open_output_file%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_open_output_file</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">const char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">filename</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">const char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">who</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Opens <span style="font-family: 楷体">filename</span> for writing in <span class="RktVal">'</span><span class="RktVal">truncate/replace</span> mode. If
 an exception is raised, the exception message uses <span style="font-family: 楷体">who</span> as the
 name of procedure that raised the exception.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Scheme_Object*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_make_file_output_port)"></a><a name="(idx._(gentag._532._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_make_file_output_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_file_output_port</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">FILE*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">fp</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Creates a Racket output file port from an ANSI C file pointer. The
 file must never block on writes.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Scheme_Object*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_make_fd_input_port)"></a><a name="(idx._(gentag._533._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_make_fd_input_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_fd_input_port</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">fd</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">name</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">regfile</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">win_textmode</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Creates a Racket input port for a file descriptor <span style="font-family: 楷体">fd</span>. On
 Windows, <span style="font-family: 楷体">fd</span> can be a <span class="stt">HANDLE</span> for a stream, and it should
 never be a file descriptor from the C library or a WinSock socket.</div></p><p>The <span style="font-family: 楷体">name</span> object is used for the port&rsquo;s name. Specify a non-zero
 value for <span style="font-family: 楷体">regfile</span> only if the file descriptor corresponds to a
 regular file (which implies that reading never blocks, for example).</p><p>On Windows, <span style="font-family: 楷体">win_textmode</span> can be non-zero to make trigger
 auto-conversion (at the byte level) of CRLF combinations to LF.</p><p>Closing the resulting port closes the file descriptor.</p><p>Instead of calling both <a href="#%28cpp._scheme_make_fd_input_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_fd_input_port</span></a> and
 <a href="#%28cpp._scheme_make_fd_output_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_fd_output_port</span></a> on the same file descriptor, call
 <a href="#%28cpp._scheme_make_fd_output_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_fd_output_port</span></a> with a non-zero last
 argument. Otherwise, closing one of the ports causes the file
 descriptor used by the other to be closed as well.</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Scheme_Object*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_make_fd_output_port)"></a><a name="(idx._(gentag._534._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_make_fd_output_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_fd_output_port</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">fd</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">name</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">regfile</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">win_textmode</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">read_too</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Creates a Racket output port for a file descriptor <span style="font-family: 楷体">fd</span>. On
 Windows, <span style="font-family: 楷体">fd</span> can be a <span class="stt">HANDLE</span> for a stream, and it should
 never be a file descriptor from the C library or a WinSock socket.</div></p><p>The <span style="font-family: 楷体">name</span> object is used for the port&rsquo;s name. Specify a non-zero
 value for <span style="font-family: 楷体">regfile</span> only if the file descriptor corresponds to a
 regular file (which implies that reading never blocks, for example).</p><p>On Windows, <span style="font-family: 楷体">win_textmode</span> can be non-zero to make trigger
 auto-conversion (at the byte level) of CRLF combinations to LF.</p><p>Closing the resulting port closes the file descriptor.</p><p>If <span style="font-family: 楷体">read_too</span> is non-zero, the function produces multiple values
 (see <a href="Evaluation.html#%28part._multiple%29" data-pltdoc="x">Multiple Values</a>) instead of a single port. The first result is
 an input port for <span style="font-family: 楷体">fd</span>, and the second is an output port for
 <span style="font-family: 楷体">fd</span>. These ports are connected in that the file descriptor is
 closed only when both of the ports are closed.</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_socket_to_ports)"></a><a name="(idx._(gentag._535._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_socket_to_ports%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_socket_to_ports</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">s</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">const char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">name</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">close</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object**</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">inp</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object**</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">outp</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Creates Racket input and output ports for a TCP socket <span style="font-family: 楷体">s</span>. The
 <span style="font-family: 楷体">name</span> argument supplies the name for the ports. If <span style="font-family: 楷体">close</span>
 is non-zero, then the ports assume responsibility for closing the
 socket. The resulting ports are written to <span style="font-family: 楷体">inp</span> and <span style="font-family: 楷体">outp</span>.</div></p><p>Whether <span style="font-family: 楷体">close</span> is zero or not, closing the resulting ports
 unregisters the file descriptor with <a href="#%28cpp._scheme_fd_to_semaphore%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_fd_to_semaphore</span></a>.
 So, passing zero for <span style="font-family: 楷体">close</span> and also using the file descriptor
 with other ports or with <a href="#%28cpp._scheme_fd_to_semaphore%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_fd_to_semaphore</span></a> will not work right.</p><p class="SHistory">&#20462;&#25913;&#20110;6.9.0.6&#29256;&#26412;&#65306;Changed ports to always unregister
with <a href="#%28cpp._scheme_fd_to_semaphore%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_fd_to_semaphore</span></a>,
since it&rsquo;s not safe to skip that
step.</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Scheme_Object*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_fd_to_semaphore)"></a><a name="(idx._(gentag._536._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_fd_to_semaphore%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_fd_to_semaphore</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">fd</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">mode</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">is_socket</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Creates or finds a Racket semaphore that becomes ready when <span style="font-family: 楷体">fd</span>
is ready. The semaphore reflects a registration with the operating
system&rsquo;s underlying mechanisms for efficient polling. When a semaphore
is created, it remains findable via <a href="#%28cpp._scheme_fd_to_semaphore%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_fd_to_semaphore</span></a> for a
particular read/write mode as long as <span style="font-family: 楷体">fd</span> has not become ready in
the read/write mode since the creation of the semaphore, or unless
<span class="stt">MZFD_REMOVE</span> has been used to remove the registered semaphore.
The <span style="font-family: 楷体">is_socket</span> argument indicates whether <span style="font-family: 楷体">fd</span> is a socket or
a filesystem descriptor; the difference matters for Windows, and it
matters for BSD-based platforms where sockets are always supported and
other file descriptors are tested for whether they correspond to a
directory or regular file.</div></p><p>The <span style="font-family: 楷体">mode</span> argument is one of the following:</p><ul><li><p><span class="stt">MZFD_CREATE_READ</span> (= <span class="stt">1</span>) &#8212;<wbr></wbr> creates or finds
a semaphore to reflect whether <span style="font-family: 楷体">fd</span> is ready for reading.</p></li><li><p><span class="stt">MZFD_CREATE_WRITE</span> (= <span class="stt">2</span>) &#8212;<wbr></wbr> creates or finds
a semaphore to reflect whether <span style="font-family: 楷体">fd</span> is ready for writing.</p></li><li><p><span class="stt">MZFD_CHECK_READ</span> (= <span class="stt">3</span>) &#8212;<wbr></wbr> finds a semaphore to
reflect whether <span style="font-family: 楷体">fd</span> is ready for reading; the result is
<span class="stt">NULL</span> if no semaphore was previously created for <span style="font-family: 楷体">fd</span> in
read mode or if such a semaphore has been posted or removed.</p></li><li><p><span class="stt">MZFD_CHECK_WRITE</span> (= <span class="stt">4</span>) &#8212;<wbr></wbr> like
<span class="stt">MZFD_CREATE_READ</span>, but for write mode.</p></li><li><p><span class="stt">MZFD_REMOVE</span> (= <span class="stt">5</span>) &#8212;<wbr></wbr> removes all recorded
semaphores for <span style="font-family: 楷体">fd</span> (unregistering a poll with the
operating system) and returns <span class="stt">NULL</span>.</p></li><li><p><span class="stt">MZFD_CREATE_VNODE</span> (= <span class="stt">6</span>) &#8212;<wbr></wbr> creates or finds a
semaphore to reflect whether <span style="font-family: 楷体">fd</span> changes; on some
platforms, <span class="stt">MZFD_CREATE_VNODE</span> is the same as
<span class="stt">MZFD_CREATE_READ</span>; on other platforms, only one or the
other can be used on a given file descriptor.</p></li><li><p><span class="stt">MZFD_CHECK_VNODE</span> (= <span class="stt">7</span>) &#8212;<wbr></wbr> like <span class="stt">MZFD_CHECK_READ</span>,
but to find a semaphore recorded via <span class="stt">MZFD_CREATE_VNODE</span>.</p></li><li><p><span class="stt">MZFD_REMOVE_VNODE</span> (= <span class="stt">8</span>) &#8212;<wbr></wbr> like <span class="stt">MZFD_REMOVE</span>,
but to remove a semaphore recorded via <span class="stt">MZFD_CREATE_VNODE</span>.</p></li></ul><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Scheme_Object*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_make_byte_string_input_port)"></a><a name="(idx._(gentag._537._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_make_byte_string_input_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_byte_string_input_port</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">str</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Creates a Racket input port from a byte string; successive
 <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Byte_and_String_Input.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._read-char%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">read-char</a></span>s on the port return successive bytes in the
 string.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Scheme_Object*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_make_byte_string_output_port)"></a><a name="(idx._(gentag._538._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_make_byte_string_output_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_byte_string_output_port</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Creates a Racket output port; all writes to the port are kept in a byte string,
 which can be obtained with <a href="#%28cpp._scheme_get_byte_string_output%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_get_byte_string_output</span></a>.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">char*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_get_byte_string_output)"></a><a name="(idx._(gentag._539._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_get_byte_string_output%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_get_byte_string_output</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Returns (in a newly allocated byte string) all data that has been
 written to the given string output port so far. (The returned string
 is nul-terminated.)</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">char*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_get_sized_byte_string_output)"></a><a name="(idx._(gentag._540._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_get_sized_byte_string_output%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_get_sized_byte_string_output</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">len</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Returns (in a newly allocated byte string) all data that has been
 written to the given string output port so far and fills in
 <span class="stt">*len</span> with the length of the string in bytes (not including the
 nul terminator).</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_pipe)"></a><a name="(idx._(gentag._541._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_pipe%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_pipe</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object**</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">read</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object**</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">write</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Creates a pair of ports, setting <span class="stt">*</span><span style="font-family: 楷体">read</span> and
 <span class="stt">*</span><span style="font-family: 楷体">write</span>; data written to <span class="stt">*</span><span style="font-family: 楷体">write</span> can be read
 back out of <span class="stt">*</span><span style="font-family: 楷体">read</span>.  The pipe can store arbitrarily many
 unread characters,</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_pipe_with_limit)"></a><a name="(idx._(gentag._542._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_pipe_with_limit%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_pipe_with_limit</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object**</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">read</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object**</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">write</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">limit</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Like <a href="#%28cpp._scheme_pipe%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_pipe</span></a> if <span style="font-family: 楷体">limit</span> is <span class="stt">0</span>. If <span style="font-family: 楷体">limit</span> is
 positive, creates a pipe that stores at most <span style="font-family: 楷体">limit</span> unread
 characters, blocking writes when the pipe is full.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Scheme_Input_Port*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_input_port_record)"></a><a name="(idx._(gentag._543._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_input_port_record%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_input_port_record</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Returns the input-port record for <span style="font-family: 楷体">port</span>, which may be either a
raw-port object with type <a href="im_values_types.html#%28cpp._scheme_input_port_type%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_input_port_type</span></a> or a structure
with the <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=portstructs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._prop%7E3ainput-port%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">prop:input-port</a></span> property.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td colspan="3"><p><span class="stt">Scheme_Output_Port*</span></p></td></tr><tr><td><p><a name="(cpp._scheme_output_port_record)"></a><a name="(idx._(gentag._544._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_output_port_record%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_output_port_record</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">port</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Returns the output-port record for <span style="font-family: 楷体">port</span>, which may be either a
raw-port object with type <a href="im_values_types.html#%28cpp._scheme_output_port_type%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_output_port_type</span></a> or a structure
with the <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=portstructs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._prop%7E3aoutput-port%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">prop:output-port</a></span> property.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">int</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_file_exists)"></a><a name="(idx._(gentag._545._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_file_exists%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_file_exists</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">name</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Returns 1 if a file by the given name exists, 0 otherwise. If
<span style="font-family: 楷体">name</span> specifies a directory, FALSE is returned.
The <span style="font-family: 楷体">name</span> should be already expanded.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">int</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_directory_exists)"></a><a name="(idx._(gentag._546._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_directory_exists%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_directory_exists</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">name</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Returns 1 if a directory by the given name exists, 0 otherwise.  The
<span style="font-family: 楷体">name</span> should be already expanded.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">char*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_expand_filename)"></a><a name="(idx._(gentag._547._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_expand_filename%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_expand_filename</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">const char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">name</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">len</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">const char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">where</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">expanded</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">checks</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Cleanses the pathname <span style="font-family: 楷体">name</span> (see <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Manipulating_Paths.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._cleanse-path%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">cleanse-path</a></span>) and
resolves relative paths with respect to the current directory
parameter. The <span style="font-family: 楷体">len</span> argument is the length of the input string;
if it is -1, the string is assumed to be null-terminated.  The
<span style="font-family: 楷体">where</span> argument is used to raise an exception if there is an
error in the filename; if this is <span class="stt">NULL</span>, an error is not reported
and <span class="stt">NULL</span> is returned instead.  If <span style="font-family: 楷体">expanded</span> is not
<span class="stt">NULL</span>, *<span style="font-family: 楷体">expanded</span> is set to 1 if some expansion takes place,
or 0 if the input name is simply returned.</div></p><p>If <span style="font-family: 楷体">guards</span> is not <span class="stt">0</span>, then <a href="security.html#%28cpp._scheme_security_check_file%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_security_check_file</span></a>
(see <a href="security.html" data-pltdoc="x">Security Guards</a>) is called with <span style="font-family: 楷体">name</span>, <span style="font-family: 楷体">where</span>, and
<span style="font-family: 楷体">checks</span> (which implies that <span style="font-family: 楷体">where</span> should never be
<span class="stt">NULL</span> unless <span style="font-family: 楷体">guards</span> is <span class="stt">0</span>). Normally, <span style="font-family: 楷体">guards</span>
should be <span class="stt">SCHEME_GUARD_FILE_EXISTS</span> at a minimum. Note that a
failed access check will result in an exception.</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">char*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_expand_string_filename)"></a><a name="(idx._(gentag._548._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_expand_string_filename%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_expand_string_filename</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">name</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">const char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">where</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">expanded</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">checks</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Like <span class="stt">scheme_expand_string</span>, but given a <span style="font-family: 楷体">name</span> that can be a
character string or a path value.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Scheme_Object*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_char_string_to_path)"></a><a name="(idx._(gentag._549._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_char_string_to_path%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_char_string_to_path</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">s</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Converts a Racket character string into a Racket path value.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Scheme_Object*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_path_to_char_string)"></a><a name="(idx._(gentag._550._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_path_to_char_string%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_path_to_char_string</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">Scheme_Object*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">s</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Converts a Racket path value into a Racket character string.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Scheme_Object*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_make_path)"></a><a name="(idx._(gentag._551._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_make_path%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_path</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">bytes</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Makes a path value given a byte string. The <span style="font-family: 楷体">bytes</span> string is copied.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Scheme_Object*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_make_path_without_copying)"></a><a name="(idx._(gentag._552._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_make_path_without_copying%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_path_without_copying</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">bytes</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Like <a href="#%28cpp._scheme_make_path%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_path</span></a>, but the string is not copied.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Scheme_Object*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_make_sized_path)"></a><a name="(idx._(gentag._553._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_make_sized_path%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_sized_path</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">bytes</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">len</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">copy</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Makes a path whose byte form has size <span style="font-family: 楷体">len</span>. A copy of <span style="font-family: 楷体">bytes</span>
is made if <span style="font-family: 楷体">copy</span> is not 0. The string <span style="font-family: 楷体">bytes</span> should contain
<span style="font-family: 楷体">len</span> bytes, and if <span style="font-family: 楷体">copy</span> is zero, <span style="font-family: 楷体">bytes</span> must have a
nul terminator in addition. If <span style="font-family: 楷体">len</span> is negative, then the
nul-terminated length of <span style="font-family: 楷体">bytes</span> is used for the length.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Scheme_Object*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_make_sized_offset_path)"></a><a name="(idx._(gentag._554._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_make_sized_offset_path%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_sized_offset_path</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">bytes</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">d</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">len</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">copy</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Like <a href="#%28cpp._scheme_make_sized_path%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_sized_path</span></a>, except the <span style="font-family: 楷体">len</span> bytes start
from position <span style="font-family: 楷体">d</span> in <span style="font-family: 楷体">bytes</span>. If <span style="font-family: 楷体">d</span> is non-zero, then
<span style="font-family: 楷体">copy</span> must be non-zero.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">char*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_build_mac_filename)"></a><a name="(idx._(gentag._555._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_build_mac_filename%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_build_mac_filename</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">FSSpec*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">spec</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">isdir</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Mac OS only: Converts an <span class="stt">FSSpec</span> record (defined by Mac OS)
into a pathname string. If <span style="font-family: 楷体">spec</span> contains only directory
information (via the <span class="stt">vRefNum</span> and <span class="stt">parID</span> fields),
<span style="font-family: 楷体">isdir</span> should be <span class="stt">1</span>, otherwise it should be <span class="stt">0</span>.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">int</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_mac_path_to_spec)"></a><a name="(idx._(gentag._556._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_mac_path_to_spec%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_mac_path_to_spec</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">const char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">filename</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">FSSpec*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">spec</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">type</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Mac OS only: Converts a pathname into an <span class="stt">FSSpec</span> record
(defined by Mac OS), returning <span class="stt">1</span> if successful and <span class="stt">0</span>
otherwise. If <span style="font-family: 楷体">type</span> is not <span class="stt">NULL</span> and <span style="font-family: 楷体">filename</span> is a
file that exists, <span style="font-family: 楷体">type</span> is filled with the file&rsquo;s four-character
Mac OS type. If <span style="font-family: 楷体">type</span> is not <span class="stt">NULL</span> and <span style="font-family: 楷体">filename</span> is
not a file that exists, <span style="font-family: 楷体">type</span> is filled with <span class="stt">0</span>.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">char*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_os_getcwd)"></a><a name="(idx._(gentag._557._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_os_getcwd%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_os_getcwd</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">buf</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">buflen</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">actlen</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">noexn</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Gets the <a name="(idx._(gentag._558._(lib._scribblings/inside/inside..scrbl)))"></a>current working directory according to the
operating system. This is separate from Racket&rsquo;s current directory
parameter.</div></p><p>The directory path is written into <span style="font-family: 楷体">buf</span>, of length <span style="font-family: 楷体">buflen</span>,
if it fits. Otherwise, a new (collectable) string is allocated for the
directory path. If <span style="font-family: 楷体">actlen</span> is not <span class="stt">NULL</span>, *<span style="font-family: 楷体">actlen</span> is
set to the length of the current directory path. If <span style="font-family: 楷体">noexn</span> is
no 0, then an exception is raised if the operation fails.</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">int</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_os_setcwd)"></a><a name="(idx._(gentag._559._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_os_setcwd%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_os_setcwd</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">buf</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">noexn</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Sets the current working directory according to the operating system. This
is separate from Racket&rsquo;s current directory parameter.</div></p><p>If <span style="font-family: 楷体">noexn</span> is not 0, then an exception is raised if the operation
fails.</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">char*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_format)"></a><a name="(idx._(gentag._560._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_format%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_format</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">mzchar*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">format</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">flen</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">argc</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object**</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">argv</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">rlen</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Creates a string like Racket&rsquo;s <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._format%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">format</a></span> procedure, using the
format string <span style="font-family: 楷体">format</span> (of length <span style="font-family: 楷体">flen</span>) and the extra
arguments specified in <span style="font-family: 楷体">argc</span> and <span style="font-family: 楷体">argv</span>. If <span style="font-family: 楷体">rlen</span> is not
<span class="stt">NULL</span>, <span class="stt">*</span><span style="font-family: 楷体">rlen</span> is filled with the length of the
resulting string.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_printf)"></a><a name="(idx._(gentag._561._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_printf%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_printf</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">format</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">flen</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">argc</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object**</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">argv</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Writes to the current output port like Racket&rsquo;s <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._printf%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">printf</a></span>
procedure, using the format string <span style="font-family: 楷体">format</span> (of length <span style="font-family: 楷体">flen</span>)
and the extra arguments specified in <span style="font-family: 楷体">argc</span> and <span style="font-family: 楷体">argv</span>.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">char*</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_format_utf8)"></a><a name="(idx._(gentag._562._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_format_utf8%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_format_utf8</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">format</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">flen</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">argc</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object**</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">argv</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">intptr_t*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">rlen</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Like <a href="#%28cpp._scheme_format%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_format</span></a>, but takes a UTF-8-encoding byte string.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">void</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_printf_utf8)"></a><a name="(idx._(gentag._563._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_printf_utf8%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_printf_utf8</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">char*</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">format</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">flen</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">int</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">argc</span><span class="stt">,</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="stt">Scheme_Object**</span><span class="hspace">&nbsp;</span><span style="font-family: 楷体">argv</span><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">Like <a href="#%28cpp._scheme_printf%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_printf</span></a>, but takes a UTF-8-encoding byte string.</div></p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">int</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="(cpp._scheme_close_should_force_port_closed)"></a><a name="(idx._(gentag._564._(lib._scribblings/inside/inside..scrbl)))"></a><a href="#%28cpp._scheme_close_should_force_port_closed%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_close_should_force_port_closed</span></a></p></td><td><p><span class="stt">(</span></p></td><td><p><span class="stt">)</span></p></td></tr></table></td></tr></table></div><div class="SIntrapara">This function must be called by the close function for a port created
 with <a href="#%28cpp._scheme_make_output_port%29" class="RktStxLink" data-pltdoc="x"><span class="stt">scheme_make_output_port</span></a>.</div></p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="…搜索手册…" title="输入搜索字符串以搜索手册" onkeypress="return DoSearchKey(event, this, &quot;7.0.0.18&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;…搜索手册…&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;…搜索手册…&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="上至文档的顶层" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.0.0.18&quot;);">&#39030;&#23618;</a></span><span class="navright">&nbsp;&nbsp;<a href="Bignums__Rationals__and_Complex_Numbers.html" title="后退至&quot;14 Bignums, Rationals, and Complex Numbers&quot;" data-pltdoc="x">&larr; &#21069;&#19968;&#39029;</a>&nbsp;&nbsp;<a href="index.html" title="上至&quot;Inside: Racket C API&quot;" data-pltdoc="x">&#19978;&#19968;&#23618;</a>&nbsp;&nbsp;<a href="Structures.html" title="前进至&quot;16 Structures&quot;" data-pltdoc="x">&#21518;&#19968;&#39029; &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>