<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>1&nbsp;DrRacket support for #lang-based Languages</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Dr<span class="mywbr"> &nbsp;</span>Racket Plugins</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Dr<span class="mywbr"> &nbsp;</span>Racket support for <span class="stt">#lang</span>-<wbr></wbr>based Languages</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="implementing-tools.html" class="tocviewlink" data-pltdoc="x">Implementing Dr<span class="mywbr"> &nbsp;</span>Racket Plugins</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="adding-languages.html" class="tocviewlink" data-pltdoc="x">Adding Languages to Dr<span class="mywbr"> &nbsp;</span>Racket</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="Creating_New_Kinds_of_DrRacket_Frames.html" class="tocviewlink" data-pltdoc="x">Creating New Kinds of Dr<span class="mywbr"> &nbsp;</span>Racket Frames</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="Extending_the_Existing_DrRacket_Classes.html" class="tocviewlink" data-pltdoc="x">Extending the Existing Dr<span class="mywbr"> &nbsp;</span>Racket Classes</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="Expanding_and_Breaking.html" class="tocviewlink" data-pltdoc="x">Expanding the User&rsquo;s Program Text and Breaking</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="Editor_Modes.html" class="tocviewlink" data-pltdoc="x">Editor Modes</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="Plugin_Capabilities.html" class="tocviewlink" data-pltdoc="x">Plugin Capabilities</a></td></tr><tr><td align="right">9&nbsp;</td><td><a href="Check_Syntax.html" class="tocviewlink" data-pltdoc="x">Check Syntax</a></td></tr><tr><td align="right">10&nbsp;</td><td><a href="Cooperating_with_Background_Check_Syntax.html" class="tocviewlink" data-pltdoc="x">Cooperating with Background Check Syntax</a></td></tr><tr><td align="right">11&nbsp;</td><td><a href="Teaching_Languages.html" class="tocviewlink" data-pltdoc="x">Teaching Languages</a></td></tr><tr><td align="right">12&nbsp;</td><td><a href="Signatures.html" class="tocviewlink" data-pltdoc="x">Signatures</a></td></tr><tr><td align="right">13&nbsp;</td><td><a href="drracket_get_extend.html" class="tocviewlink" data-pltdoc="x"><span class="stt">drracket:<span class="mywbr"> &nbsp;</span>get/<span class="mywbr"> &nbsp;</span>extend</span></a></td></tr><tr><td align="right">14&nbsp;</td><td><a href="drracket_unit.html" class="tocviewlink" data-pltdoc="x"><span class="stt">drracket:<span class="mywbr"> &nbsp;</span>unit</span></a></td></tr><tr><td align="right">15&nbsp;</td><td><a href="drracket_language.html" class="tocviewlink" data-pltdoc="x"><span class="stt">drracket:<span class="mywbr"> &nbsp;</span>language</span></a></td></tr><tr><td align="right">16&nbsp;</td><td><a href="drracket_language-configuration.html" class="tocviewlink" data-pltdoc="x"><span class="stt">drracket:<span class="mywbr"> &nbsp;</span>language-<wbr></wbr>configuration</span></a></td></tr><tr><td align="right">17&nbsp;</td><td><a href="drracket_debug.html" class="tocviewlink" data-pltdoc="x"><span class="stt">drracket:<span class="mywbr"> &nbsp;</span>debug</span></a></td></tr><tr><td align="right">18&nbsp;</td><td><a href="drracket_rep.html" class="tocviewlink" data-pltdoc="x"><span class="stt">drracket:<span class="mywbr"> &nbsp;</span>rep</span></a></td></tr><tr><td align="right">19&nbsp;</td><td><a href="drracket_frame.html" class="tocviewlink" data-pltdoc="x"><span class="stt">drracket:<span class="mywbr"> &nbsp;</span>frame</span></a></td></tr><tr><td align="right">20&nbsp;</td><td><a href="drracket_help-desk.html" class="tocviewlink" data-pltdoc="x"><span class="stt">drracket:<span class="mywbr"> &nbsp;</span>help-<wbr></wbr>desk</span></a></td></tr><tr><td align="right">21&nbsp;</td><td><a href="drracket_eval.html" class="tocviewlink" data-pltdoc="x"><span class="stt">drracket:<span class="mywbr"> &nbsp;</span>eval</span></a></td></tr><tr><td align="right">22&nbsp;</td><td><a href="drracket_modes.html" class="tocviewlink" data-pltdoc="x"><span class="stt">drracket:<span class="mywbr"> &nbsp;</span>modes</span></a></td></tr><tr><td align="right">23&nbsp;</td><td><a href="drracket_module-language-tools.html" class="tocviewlink" data-pltdoc="x"><span class="stt">drracket:<span class="mywbr"> &nbsp;</span>module-<wbr></wbr>language-<wbr></wbr>tools</span></a></td></tr><tr><td align="right">24&nbsp;</td><td><a href="drracket_module-language.html" class="tocviewlink" data-pltdoc="x"><span class="stt">drracket:<span class="mywbr"> &nbsp;</span>module-<wbr></wbr>language</span></a></td></tr><tr><td align="right">25&nbsp;</td><td><a href="drracket_tracing.html" class="tocviewlink" data-pltdoc="x"><span class="stt">drracket:<span class="mywbr"> &nbsp;</span>tracing</span></a></td></tr><tr><td align="right">26&nbsp;</td><td><a href="Backwards_Compatibility.html" class="tocviewlink" data-pltdoc="x">Backwards Compatibility</a></td></tr><tr><td align="right"></td><td><a href="doc-index.html" class="tocviewlink" data-pltdoc="x">Index</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>1&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Dr<span class="mywbr"> &nbsp;</span>Racket support for <span class="stt">#lang</span>-<wbr></wbr>based Languages</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">1.1&nbsp;</td><td><a href="#%28part._.Syntax_.Coloring%29" class="tocviewlink" data-pltdoc="x">Syntax Coloring</a></td></tr><tr><td align="right">1.2&nbsp;</td><td><a href="#%28part._.Indentation%29" class="tocviewlink" data-pltdoc="x">Indentation</a></td></tr><tr><td align="right">1.3&nbsp;</td><td><a href="#%28part._.Keystrokes%29" class="tocviewlink" data-pltdoc="x">Keystrokes</a></td></tr><tr><td align="right">1.4&nbsp;</td><td><a href="#%28part._.Filename_.Extensions%29" class="tocviewlink" data-pltdoc="x">Filename Extensions</a></td></tr><tr><td align="right">1.5&nbsp;</td><td><a href="#%28part._.R.E.P.L_.Submit_.Predicate%29" class="tocviewlink" data-pltdoc="x">REPL Submit Predicate</a></td></tr><tr><td align="right">1.6&nbsp;</td><td><a href="#%28part._.Show_big__.Definitions__and__.Interactions__labels%29" class="tocviewlink" data-pltdoc="x">Show big &#8220;Definitions&#8221; and &#8220;Interactions&#8221; labels</a></td></tr><tr><td align="right">1.7&nbsp;</td><td><a href="#%28part._.Opting_out_of_.Standard_.Toolbar_.Buttons%29" class="tocviewlink" data-pltdoc="x">Opting out of Standard Toolbar Buttons</a></td></tr><tr><td align="right">1.8&nbsp;</td><td><a href="#%28part._.Opting_in_to_.Language-.Specific_.Toolbar_.Buttons%29" class="tocviewlink" data-pltdoc="x">Opting in to Language-<wbr></wbr>Specific Toolbar Buttons</a></td></tr><tr><td align="right">1.9&nbsp;</td><td><a href="#%28part._.Adding_.New_.Toolbar_.Buttons%29" class="tocviewlink" data-pltdoc="x">Adding New Toolbar Buttons</a></td></tr><tr><td align="right">1.10&nbsp;</td><td><a href="#%28part._sec~3adefinitions-text-surrogate%29" class="tocviewlink" data-pltdoc="x">Definitions Text Surrogate</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">在本页中：</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">1.1<tt>&nbsp;</tt></span><a href="#%28part._.Syntax_.Coloring%29" class="tocsubseclink" data-pltdoc="x">Syntax Coloring</a></td></tr><tr><td><span class="tocsublinknumber">1.2<tt>&nbsp;</tt></span><a href="#%28part._.Indentation%29" class="tocsubseclink" data-pltdoc="x">Indentation</a></td></tr><tr><td><span class="tocsublinknumber">1.3<tt>&nbsp;</tt></span><a href="#%28part._.Keystrokes%29" class="tocsubseclink" data-pltdoc="x">Keystrokes</a></td></tr><tr><td><span class="tocsublinknumber">1.4<tt>&nbsp;</tt></span><a href="#%28part._.Filename_.Extensions%29" class="tocsubseclink" data-pltdoc="x">Filename Extensions</a></td></tr><tr><td><span class="tocsublinknumber">1.5<tt>&nbsp;</tt></span><a href="#%28part._.R.E.P.L_.Submit_.Predicate%29" class="tocsubseclink" data-pltdoc="x">REPL Submit Predicate</a></td></tr><tr><td><span class="tocsublinknumber">1.6<tt>&nbsp;</tt></span><a href="#%28part._.Show_big__.Definitions__and__.Interactions__labels%29" class="tocsubseclink" data-pltdoc="x">Show big &#8220;Definitions&#8221; and &#8220;Interactions&#8221; labels</a></td></tr><tr><td><span class="tocsublinknumber">1.7<tt>&nbsp;</tt></span><a href="#%28part._.Opting_out_of_.Standard_.Toolbar_.Buttons%29" class="tocsubseclink" data-pltdoc="x">Opting out of Standard Toolbar Buttons</a></td></tr><tr><td><span class="tocsublinknumber">1.8<tt>&nbsp;</tt></span><a href="#%28part._.Opting_in_to_.Language-.Specific_.Toolbar_.Buttons%29" class="tocsubseclink" data-pltdoc="x">Opting in to Language-<wbr></wbr>Specific Toolbar Buttons</a></td></tr><tr><td><span class="tocsublinknumber">1.9<tt>&nbsp;</tt></span><a href="#%28part._.Adding_.New_.Toolbar_.Buttons%29" class="tocsubseclink" data-pltdoc="x">Adding New Toolbar Buttons</a></td></tr><tr><td><span class="tocsublinknumber">1.10<tt>&nbsp;</tt></span><a href="#%28part._sec~3adefinitions-text-surrogate%29" class="tocsubseclink" data-pltdoc="x">Definitions Text Surrogate</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="…搜索手册…" title="输入搜索字符串以搜索手册" onkeypress="return DoSearchKey(event, this, &quot;7.0.0.18&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;…搜索手册…&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;…搜索手册…&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="上至文档的顶层" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.0.0.18&quot;);">&#39030;&#23618;</a></span><span class="navright">&nbsp;&nbsp;<a href="index.html" title="后退至&quot;DrRacket Plugins&quot;" data-pltdoc="x">&larr; &#21069;&#19968;&#39029;</a>&nbsp;&nbsp;<a href="index.html" title="上至&quot;DrRacket Plugins&quot;" data-pltdoc="x">&#19978;&#19968;&#23618;</a>&nbsp;&nbsp;<a href="implementing-tools.html" title="前进至&quot;2 Implementing DrRacket Plugins&quot;" data-pltdoc="x">&#21518;&#19968;&#39029; &rarr;</a></span>&nbsp;</div><h3 x-source-module="(lib &quot;scribblings/tools/tools.scrbl&quot;)" x-source-pkg="drracket" x-part-tag="&quot;lang-languages-customization&quot;">1<tt>&nbsp;</tt><a name="(part._lang-languages-customization)"></a>DrRacket support for <span class="stt">#lang</span>-based Languages</h3><p>The simplest and best way to extend DrRacket with support
for a new language is to implement the language via <span class="stt">#lang</span> (see
<a href="http://docs.racket-lang.org/local-redirect/index.html?doc=guide&amp;rel=hash-languages.html&amp;version=7.0.0.18" class="Sq" data-pltdoc="x">Defining new <span class="RktModLink"><span class="RktMod">#lang</span></span> Languages</a>
for more details). DrRacket will then use <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Reading.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._read-language%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">read-language</a></span> to
find code and values that it uses to customize itself to the language.</p><p>If the call to <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Reading.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._read-language%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">read-language</a></span> raises an error,
DrRacket logs the error at the <span class="RktVar">debug</span> level to a
logger with the name <span class="RktVal">'</span><span class="RktVal">drracket-language</span> (see
<a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=logging.html&amp;version=7.0.0.18" class="Sq" data-pltdoc="x">Logging</a>
for more about how to follow specific loggers).</p><p>With the exception of the
<span class="RktVal">'</span><span class="RktVal">definitions-text-surrogate</span>, if there is an error
during a use of one of these extensions, DrRacket notices
the error and removes all of the extensions for the
language. It also shows the error at the bottom of the
DrRacket frame (prefixed by <span class="stt">#lang</span>). Note that this
applies only to errors that occur during the dynamic extent
of a use of one of these extensions. If an extension were to,
for example, create a new thread that (eventually) caused an
error, DrRacket would not notice that error and would not
remove the extensions.</p><p>When experimenting with changes to these extensions, use the
<span class="ssansserif">Racket|Reload #lang extensions</span> menu item to
cause DrRacket to remove the extensions and reload the
implementations from the files on disk.</p><p>DrRacket calls the language&rsquo;s <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Reading.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._read-language%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">read-language</a></span>&rsquo;s
<span class="RktVar">get-info</span> procedure with the following
<span class="RktVar">key</span> arguments:</p><ul><li><p><a href="#%28elem._drracket~3adefault-filters%29" data-pltdoc="x"><span class="RktSym">drracket:default-filters</span></a></p></li><li><p><a href="#%28elem._drracket~3adefault-extension%29" data-pltdoc="x"><span class="RktSym">drracket:default-extension</span></a></p></li><li><p><a href="#%28elem._drracket~3aindentation%29" data-pltdoc="x"><span class="RktSym">drracket:indentation</span></a></p></li><li><p><a href="#%28elem._drracket~3akeystrokes%29" data-pltdoc="x"><span class="RktSym">drracket:keystrokes</span></a></p></li><li><p><a href="#%28elem._drracket~3ashow-big-defs%2Fints-labels%29" data-pltdoc="x"><span class="RktSym">drracket:show-big-defs/ints-labels</span></a></p></li><li><p><a href="#%28elem._drracket~3aopt-out-toolbar-buttons%29" data-pltdoc="x"><span class="RktSym">drracket:opt-out-toolbar-buttons</span></a></p></li><li><p><a href="#%28elem._drracket~3aopt-in-toolbar-buttons%29" data-pltdoc="x"><span class="RktSym">drracket:opt-in-toolbar-buttons</span></a></p></li><li><p><a href="#%28elem._drracket~3asubmit-predicate%29" data-pltdoc="x"><span class="RktSym">drracket:submit-predicate</span></a></p></li><li><p><a href="#%28elem._drracket~3atoolbar-buttons%29" data-pltdoc="x"><span class="RktSym">drracket:toolbar-buttons</span></a></p></li><li><p><a href="#%28elem._color-lexer%29" data-pltdoc="x"><span class="RktSym">color-lexer</span></a></p></li><li><p><a href="#%28elem._definitions-text-surrogate%29" data-pltdoc="x"><span class="RktSym">definitions-text-surrogate</span></a></p></li></ul><h4 x-source-module="(lib &quot;scribblings/tools/tools.scrbl&quot;)" x-source-pkg="drracket" x-part-tag="&quot;Syntax_Coloring&quot;">1.1<tt>&nbsp;</tt><a name="(part._.Syntax_.Coloring)"></a>Syntax Coloring</h4><p><a name="(elem._color-lexer)"></a>When a language&rsquo;s <a name="(idx._(gentag._0._(lib._scribblings/tools/tools..scrbl)))"></a><span class="RktVar">get-info</span> procedure responds to <span class="RktVal">'</span><span class="RktVal">color-lexer</span>, it
is expected to return a procedure suitable to pass as the <span class="RktVar">get-token</span>
argument to <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=framework&amp;rel=Color.html%23%2528meth._%2528%2528%2528lib._framework%252Fmain..rkt%2529._color%7E3atext%7E3c%7E25%7E3e%2529._start-colorer%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">start-colorer</a></span>.</p><p><div class="SIntrapara">The recognized token styles (specified implicitly via <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=framework&amp;rel=Color.html%23%2528meth._%2528%2528%2528lib._framework%252Fmain..rkt%2529._color%7E3atext%7E3c%7E25%7E3e%2529._start-colorer%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">start-colorer</a></span>&rsquo;s
<span class="RktVar">token-sym-&gt;style</span> argument) are:
</div><div class="SIntrapara"><ul><li><p><a name="(idx._(gentag._1._(lib._scribblings/tools/tools..scrbl)))"></a><span class="RktVal">'</span><span class="RktVal">symbol</span></p></li><li><p><a name="(idx._(gentag._2._(lib._scribblings/tools/tools..scrbl)))"></a><span class="RktVal">'</span><span class="RktVal">keyword</span></p></li><li><p><a name="(idx._(gentag._3._(lib._scribblings/tools/tools..scrbl)))"></a><span class="RktVal">'</span><span class="RktVal">comment</span></p></li><li><p><a name="(idx._(gentag._4._(lib._scribblings/tools/tools..scrbl)))"></a><span class="RktVal">'</span><span class="RktVal">string</span></p></li><li><p><a name="(idx._(gentag._5._(lib._scribblings/tools/tools..scrbl)))"></a><span class="RktVal">'</span><span class="RktVal">constant</span></p></li><li><p><a name="(idx._(gentag._6._(lib._scribblings/tools/tools..scrbl)))"></a><span class="RktVal">'</span><span class="RktVal">parenthesis</span></p></li><li><p><a name="(idx._(gentag._7._(lib._scribblings/tools/tools..scrbl)))"></a><span class="RktVal">'</span><span class="RktVal">error</span></p></li><li><p><a name="(idx._(gentag._8._(lib._scribblings/tools/tools..scrbl)))"></a><span class="RktVal">'</span><span class="RktVal">other</span></p></li></ul></div><div class="SIntrapara">These precise colors for these identifiers are controlled by the preferences dialog in DrRacket.</div></p><h4 x-source-module="(lib &quot;scribblings/tools/tools.scrbl&quot;)" x-source-pkg="drracket" x-part-tag="&quot;Indentation&quot;">1.2<tt>&nbsp;</tt><a name="(part._.Indentation)"></a>Indentation</h4><p><div class="SIntrapara"><a name="(elem._drracket~3aindentation)"></a>When a language&rsquo;s <a name="(idx._(gentag._9._(lib._scribblings/tools/tools..scrbl)))"></a><span class="RktVar">get-info</span> procedure responds to <span class="RktVal">'</span><span class="RktVal">drracket:indentation</span>,
it is expected to return a function with this contract:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=7.0.0.18" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Object_and_Class_Contracts.html%23%2528def._%2528%2528lib._racket%252Fclass..rkt%2529._is-a%7E3f%252Fc%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">is-a?/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=framework&amp;rel=Racket.html%23%2528def._%2528%2528lib._framework%252Fmain..rkt%2529._racket%7E3atext%7E3c%7E25%7E3e%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">racket:text&lt;%&gt;</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-nonnegative-integer%7E3f%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">exact-nonnegative-integer?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-nonnegative-integer%7E3f%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">exact-nonnegative-integer?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">The function is used
to indent lines in DrRacket. It is called with the position containing the line to be
indented. It is expected to return the number of spaces that should appear at the beginning
of the line or <span class="RktVal">#f</span>. If <span class="RktVal">#f</span> is returned,
DrRacket uses the standard s-expression indentation rules.</div></p><p class="SHistory">&#28155;&#21152;&#20110;package <span class="stt">drracket</span>&#30340;1.3&#29256;&#26412;&#12290;</p><h4 x-source-module="(lib &quot;scribblings/tools/tools.scrbl&quot;)" x-source-pkg="drracket" x-part-tag="&quot;Keystrokes&quot;">1.3<tt>&nbsp;</tt><a name="(part._.Keystrokes)"></a>Keystrokes</h4><p><div class="SIntrapara"><a name="(elem._drracket~3akeystrokes)"></a><a name="(idx._(gentag._10._(lib._scribblings/tools/tools..scrbl)))"></a>When a language&rsquo;s <span class="RktVar">get-info</span> procedure responds to
<span class="RktVal">'</span><span class="RktVal">drracket:keystrokes</span>, it is expected
to return a list of keybindings and callbacks matching this contract:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._list%252Fc%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">list/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=7.0.0.18" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Object_and_Class_Contracts.html%23%2528def._%2528%2528lib._racket%252Fclass..rkt%2529._is-a%7E3f%252Fc%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">is-a?/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=gui&amp;rel=text_.html&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">text%</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Object_and_Class_Contracts.html%23%2528def._%2528%2528lib._racket%252Fclass..rkt%2529._is-a%7E3f%252Fc%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">is-a?/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=gui&amp;rel=event_.html&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">event%</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%2529%2529&amp;version=7.0.0.18" class="RktStxLink Sq" data-pltdoc="x">any</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Each element of the list is a different keybinding, where the
string indicates the keystroke (see the documentation for
<span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=gui&amp;rel=keymap_.html%23%2528meth._%2528%2528%2528lib._mred%252Fmain..rkt%2529._keymap%7E25%2529._map-function%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">map-function</a></span> for the precise contents of the
string and how it maps to particular keystrokes) and the procedure
is called when the user types that keystroke in the definitions
window.</div></p><p>The procedure&rsquo;s first argument will be the definitions text, the
second will be the event object supplied from the GUI system
and the result of the procedure is ignored.</p><h4 x-source-module="(lib &quot;scribblings/tools/tools.scrbl&quot;)" x-source-pkg="drracket" x-part-tag="&quot;Filename_Extensions&quot;">1.4<tt>&nbsp;</tt><a name="(part._.Filename_.Extensions)"></a>Filename Extensions</h4><p><a name="(elem._drracket~3adefault-filters)"></a>When a language&rsquo;s <a name="(idx._(gentag._11._(lib._scribblings/tools/tools..scrbl)))"></a><span class="RktVar">get-info</span> procedure responds to
<span class="RktVal">'</span><span class="RktVal">drracket:default-filters</span>, it is expected to return
<span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._list%252Fc%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">list/c</a></span><span class="stt"> </span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="stt"> </span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="RktPn">)</span><span class="RktPn">)</span>.</p><p><div class="SIntrapara">These results are added as a prefix to <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=framework&amp;rel=Finder.html%23%2528def._%2528%2528lib._framework%252Fmain..rkt%2529._finder%7E3adefault-filters%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">finder:default-filters</a></span>,
extending the default that DrRacket normally uses, namely:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktVal">`</span><span class="RktVal">(</span><span class="RktVal">[</span><span class="RktVal">"Racket Sources"</span><span class="hspace">&nbsp;</span><span class="RktVal">"*.rkt;*.scrbl;*.rktl;*.rktd;*.ss;*.scm"</span><span class="RktVal">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">[</span><span class="RktVal">"Any"</span><span class="hspace">&nbsp;</span><span class="RktVal">"*.*"</span><span class="RktVal">]</span><span class="RktVal">)</span></td></tr></table></blockquote></div><div class="SIntrapara"><p class="SHistory">&#28155;&#21152;&#20110;package <span class="stt">drracket</span>&#30340;1.2&#29256;&#26412;&#12290;</p></div></p><p><a name="(elem._drracket~3adefault-extension)"></a>When a language&rsquo;s <a name="(idx._(gentag._12._(lib._scribblings/tools/tools..scrbl)))"></a><span class="RktVar">get-info</span> procedure responds to <span class="RktVal">'</span><span class="RktVal">drracket:default-extension</span>,
it is expected to return <span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._and%252Fc%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">and/c</a></span><span class="stt"> </span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._not%252Fc%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">not/c</a></span><span class="stt"> </span><span class="RktVal">#rx"[.]"</span><span class="RktPn">)</span><span class="RktPn">)</span>; the result is used
as the default extension when saving files by setting <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=framework&amp;rel=Finder.html%23%2528def._%2528%2528lib._framework%252Fmain..rkt%2529._finder%7E3adefault-extension%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">finder:default-extension</a></span>.</p><p class="SHistory">&#28155;&#21152;&#20110;package <span class="stt">drracket</span>&#30340;1.2&#29256;&#26412;&#12290;</p><h4 x-source-module="(lib &quot;scribblings/tools/tools.scrbl&quot;)" x-source-pkg="drracket" x-part-tag="&quot;REPL_Submit_Predicate&quot;">1.5<tt>&nbsp;</tt><a name="(part._.R.E.P.L_.Submit_.Predicate)"></a>REPL Submit Predicate</h4><p><div class="SIntrapara"><a name="(elem._drracket~3asubmit-predicate)"></a><a name="(idx._(gentag._13._(lib._scribblings/tools/tools..scrbl)))"></a>When using the language
 declared in the source, DrRacket queries that language via
 <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Reading.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._read-language%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">read-language</a></span> to determine if an expression in the
 interactions window is ready to be submitted to the
 evaluator (when the user types return). The info procedure
 is passed <span class="RktVal">'</span><span class="RktVal">drracket:submit-predicate</span> and
 should return a function matching this contract:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=7.0.0.18" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=port-ops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._input-port%7E3f%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">input-port?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">This function&rsquo;s first argument is a port that contains the
 interactions window&rsquo;s data, starting just after the prompt
 and continuing to the end of the editor. The second argument
 is a boolean indicating if the insertion point is followed
 only by whitespace. The results should be a boolean
 indicating if the expression should be evaluated. </div></p><p>For backwards compatibility reasons, DrRacket also queries
the result of <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Module_Names_and_Loading.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._module-%7E3elanguage-info%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">module-&gt;language-info</a></span> for
<span class="RktVal">'</span><span class="RktVal">drracket:submit-predicate</span>. It does this during
the evaluation of the definitions (so the
<span class="ssansserif">Racket|Reload #lang extensions</span> menu item
does not trigger a re-load). If the submit predicate is
specified both ways, then the predicate supplied via
<span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Reading.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._read-language%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">read-language</a></span> takes precedence.</p><p class="SHistory">&#20462;&#25913;&#20110;package <span class="stt">drracket</span>&#30340;1.5&#29256;&#26412;&#65306;Look for <span class="RktSym">drracket:submit-predicate</span> via
<span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Reading.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._read-language%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">read-language</a></span>.</p><h4 x-source-module="(lib &quot;scribblings/tools/tools.scrbl&quot;)" x-source-pkg="drracket" x-part-tag="&quot;Show_big__Definitions__and__Interactions__labels&quot;">1.6<tt>&nbsp;</tt><a name="(part._.Show_big__.Definitions__and__.Interactions__labels)"></a>Show big &#8220;Definitions&#8221; and &#8220;Interactions&#8221; labels</h4><p><a name="(elem._drracket~3ashow-big-defs/ints-labels)"></a><a name="(idx._(gentag._14._(lib._scribblings/tools/tools..scrbl)))"></a>If the <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Reading.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._read-language%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">read-language</a></span> predicate returns <span class="RktVal">#t</span>
for <span class="RktVal">'</span><span class="RktVal">drracket:show-big-defs/ints-labels</span>, then DrRacket
shows the words &#8220;Definitions&#8221; and &#8220;Interactions&#8221; in a large
font in the corresponding windows. This is intended as a help
for students who are reading instructions about where to type
their programs but might not have internalized this particular
bit of DrRacket terminology.</p><h4 x-source-module="(lib &quot;scribblings/tools/tools.scrbl&quot;)" x-source-pkg="drracket" x-part-tag="&quot;Opting_out_of_Standard_Toolbar_Buttons&quot;">1.7<tt>&nbsp;</tt><a name="(part._.Opting_out_of_.Standard_.Toolbar_.Buttons)"></a>Opting out of Standard Toolbar Buttons</h4><p><a name="(elem._drracket~3aopt-out-toolbar-buttons)"></a>Some of the built-in buttons in the DrRacket button bar at the top of the<a name="(idx._(gentag._15._(lib._scribblings/tools/tools..scrbl)))"></a>
window can be disabled on a per-language basis.
DrRacket will invoke the <span class="RktVar">get-info</span> proc returned by <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Reading.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._read-language%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">read-language</a></span> with
<span class="RktVal">'</span><span class="RktVal">drracket:opt-out-toolbar-buttons</span>
(and <a name="(idx._(gentag._16._(lib._scribblings/tools/tools..scrbl)))"></a><span class="RktVal">'</span><span class="RktVal">drscheme:opt-out-toolbar-buttons</span> for backwards compatibility).</p><p>If the result is a list of symbols, the
listed symbols are opted out. If the result is <span class="RktVal">#f</span>, all buttons are opted
out. The default is the empty list, meaning that all opt-out buttons appear.</p><p>The Check Syntax button uses the symbol <span class="RktVal">'</span><span class="RktVal">drracket:syncheck</span>; the debugger
uses the symbol <span class="RktVal">'</span><span class="RktVal">debug-tool</span> and the macro stepper uses <span class="RktVal">'</span><span class="RktVal">macro-stepper</span>.</p><p>Plugins may add more opt-out buttons via
<span class="RktSym"><a href="drracket_module-language-tools.html#%28def._%28%28lib._drracket%2Ftool-lib..rkt%29._drracket~3amodule-language-tools~3aadd-opt-out-toolbar-button%29%29" class="RktValLink" data-pltdoc="x">drracket:module-language-tools:add-opt-out-toolbar-button</a></span>.</p><h4 x-source-module="(lib &quot;scribblings/tools/tools.scrbl&quot;)" x-source-pkg="drracket" x-part-tag="&quot;Opting_in_to_Language-Specific_Toolbar_Buttons&quot;">1.8<tt>&nbsp;</tt><a name="(part._.Opting_in_to_.Language-.Specific_.Toolbar_.Buttons)"></a>Opting in to Language-Specific Toolbar Buttons</h4><p><a name="(elem._drracket~3aopt-in-toolbar-buttons)"></a>Like <a name="(idx._(gentag._17._(lib._scribblings/tools/tools..scrbl)))"></a><a href="#%28elem._drracket~3aopt-out-toolbar-buttons%29" data-pltdoc="x"><span class="RktSym">drracket:opt-out-toolbar-buttons</span></a>, but for languages to opt in to
buttons that are not enabled by default.</p><p><div class="SIntrapara">Plugins may add more opt-out buttons via
<span class="RktSym"><a href="drracket_module-language-tools.html#%28def._%28%28lib._drracket%2Ftool-lib..rkt%29._drracket~3amodule-language-tools~3aadd-opt-in-toolbar-button%29%29" class="RktValLink" data-pltdoc="x">drracket:module-language-tools:add-opt-in-toolbar-button</a></span>.
</div><div class="SIntrapara"><p class="SHistory">&#28155;&#21152;&#20110;package <span class="stt">drracket</span>&#30340;1.6&#29256;&#26412;&#12290;</p></div></p><h4 x-source-module="(lib &quot;scribblings/tools/tools.scrbl&quot;)" x-source-pkg="drracket" x-part-tag="&quot;Adding_New_Toolbar_Buttons&quot;">1.9<tt>&nbsp;</tt><a name="(part._.Adding_.New_.Toolbar_.Buttons)"></a>Adding New Toolbar Buttons</h4><p><a name="(elem._drracket~3atoolbar-buttons)"></a>DrRacket queries the result of <a name="(idx._(gentag._18._(lib._scribblings/tools/tools..scrbl)))"></a><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Reading.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._read-language%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">read-language</a></span>
to determine if there are any new toolbar
buttons to be used when editing files in this language.</p><p><div class="SIntrapara">Specifically, DrRacket will pass <span class="RktVal">'</span><span class="RktVal">drracket:toolbar-buttons</span>
to the function and expect back a value matching this contract:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._list%252Fc%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">list/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Object_and_Class_Contracts.html%23%2528def._%2528%2528lib._racket%252Fclass..rkt%2529._is-a%7E3f%252Fc%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">is-a?/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=draw&amp;rel=bitmap_.html&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">bitmap%</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=7.0.0.18" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Object_and_Class_Contracts.html%23%2528def._%2528%2528lib._racket%252Fclass..rkt%2529._is-a%7E3f%252Fc%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">is-a?/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="drracket_unit.html#%28def._%28%28lib._drracket%2Ftool-lib..rkt%29._drracket~3aunit~3aframe~3c~25~3e%29%29" class="RktValLink" data-pltdoc="x">drracket:unit:frame&lt;%&gt;</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%2529%2529&amp;version=7.0.0.18" class="RktStxLink Sq" data-pltdoc="x">any</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._real%7E3f%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">real?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">which is then used to create new toolbar buttons, one for each element
in the result list. The string is the label on the button; the bitmap is the icon
(it should be 16x16 pixels); the function is called when the button is clicked;
and the number is passed as the <span class="RktPn">#:number</span> argument to
<span class="RktSym"><a href="drracket_unit.html#%28meth._%28%28%28lib._drracket%2Ftool-lib..rkt%29._drracket~3aunit~3aframe~3c~25~3e%29._register-toolbar-button%29%29" class="RktValLink" data-pltdoc="x">register-toolbar-button</a></span>.</div></p><p>If the result is <span class="RktVal">#f</span>, then no toolbar buttons are created.</p><p>To implement functionality similar to the Run button, call the
<span class="RktSym"><a href="drracket_unit.html#%28meth._%28%28%28lib._drracket%2Ftool-lib..rkt%29._drracket~3aunit~3aframe~25%29._execute-callback%29%29" class="RktValLink" data-pltdoc="x">execute-callback</a></span> method. You may also
want to use the <span class="RktSym"><a href="drracket_rep.html#%28def._%28%28lib._drracket%2Ftool-lib..rkt%29._drracket~3arep~3aafter-expression%29%29" class="RktValLink" data-pltdoc="x">drracket:rep:after-expression</a></span> parameter.</p><p>If <span class="RktVal">'</span><span class="RktVal">drracket:toolbar-buttons</span> is not recognized, DrRacket will also
pass <a name="(idx._(gentag._19._(lib._scribblings/tools/tools..scrbl)))"></a><span class="RktVal">'</span><span class="RktVal">drscheme:toolbar-buttons</span>; this is for backwards
compatibility and new code should not use it.
Similarly, if the fourth element from the list (the argument to <span class="RktPn">#:number</span>)
is not present, then it is treated as <span class="RktVal">#f</span>.</p><h4 x-source-module="(lib &quot;scribblings/tools/tools.scrbl&quot;)" x-source-pkg="drracket" x-part-tag="&quot;sec:definitions-text-surrogate&quot;">1.10<tt>&nbsp;</tt><a name="(part._sec~3adefinitions-text-surrogate)"></a>Definitions Text Surrogate</h4><p>Using a <span class="stt">#lang</span>-specific definitions text surrogate is a
very powerful way to flexibly control DrRacket&rsquo;s behavior
when a new language is installed. It is also easy to cause
DrRacket to completely misbehave with this form of
extension. It is here only when one of the other forms of
extension listed above are not sufficient for the kind of
extension your language requires. And even in that case, it
is preferable to add something to this list that is more
easily controlled in the case of errors, using the
definitions text surrogate only until that more easily
controlled extension has been added to DrRacket.</p><p><a name="(elem._definitions-text-surrogate)"></a> DrRacket<a name="(idx._(gentag._20._(lib._scribblings/tools/tools..scrbl)))"></a>
calls <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Reading.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._read-language%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">read-language</a></span>&rsquo;s <span class="RktSym">get-info</span> procedure
with <span class="RktVal">'</span><span class="RktVal">definitions-text-surrogate</span> and expects it to
return a value matching the contract
<span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="stt"> </span><span class="RktVal">#f</span><span class="stt"> </span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Module_Names_and_Loading.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._module-path%7E3f%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">module-path?</a></span><span class="RktPn">)</span>, which is then passed to
<span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Module_Names_and_Loading.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._dynamic-require%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">dynamic-require</a></span> together with <span class="RktVal">'</span><span class="RktVal">surrogate%</span>.
The result is expected to be a class implementing the
interface <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=framework&amp;rel=Racket.html%23%2528def._%2528%2528lib._framework%252Fmain..rkt%2529._racket%7E3atext-mode%7E3c%7E25%7E3e%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">racket:text-mode&lt;%&gt;</a></span> (presumably
derived from <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=framework&amp;rel=Racket.html%23%2528def._%2528%2528lib._framework%252Fmain..rkt%2529._racket%7E3atext-mode%7E25%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">racket:text-mode%</a></span>. That mode is
installed into the definitions text, where it can change its
behavior by changing how is responds to any of the methods
in the mode. </p><p>One consequence of this power is that errors that happen
during the dynamic extent of calls into the mode are not
trapped (much as errors that occur on newly created threads
are not trapped, as described in the introduction to this
section).</p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="…搜索手册…" title="输入搜索字符串以搜索手册" onkeypress="return DoSearchKey(event, this, &quot;7.0.0.18&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;…搜索手册…&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;…搜索手册…&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="上至文档的顶层" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.0.0.18&quot;);">&#39030;&#23618;</a></span><span class="navright">&nbsp;&nbsp;<a href="index.html" title="后退至&quot;DrRacket Plugins&quot;" data-pltdoc="x">&larr; &#21069;&#19968;&#39029;</a>&nbsp;&nbsp;<a href="index.html" title="上至&quot;DrRacket Plugins&quot;" data-pltdoc="x">&#19978;&#19968;&#23618;</a>&nbsp;&nbsp;<a href="implementing-tools.html" title="前进至&quot;2 Implementing DrRacket Plugins&quot;" data-pltdoc="x">&#21518;&#19968;&#39029; &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>