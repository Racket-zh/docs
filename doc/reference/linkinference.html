<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>7.4&nbsp;Inferred Linking</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="extras.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">The Racket Reference</a></td></tr></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="model.html" class="tocviewlink" data-pltdoc="x">Language Model</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="notation.html" class="tocviewlink" data-pltdoc="x">Notation for Documentation</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="syntax.html" class="tocviewlink" data-pltdoc="x">Syntactic Forms</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="data.html" class="tocviewlink" data-pltdoc="x">Datatypes</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="structures.html" class="tocviewlink" data-pltdoc="x">Structures</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="mzlib_class.html" class="tocviewlink" data-pltdoc="x">Classes and Objects</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="mzlib_unit.html" class="tocviewselflink" data-pltdoc="x">Units</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="contracts.html" class="tocviewlink" data-pltdoc="x">Contracts</a></td></tr><tr><td align="right">9&nbsp;</td><td><a href="match.html" class="tocviewlink" data-pltdoc="x">Pattern Matching</a></td></tr><tr><td align="right">10&nbsp;</td><td><a href="control.html" class="tocviewlink" data-pltdoc="x">Control Flow</a></td></tr><tr><td align="right">11&nbsp;</td><td><a href="concurrency.html" class="tocviewlink" data-pltdoc="x">Concurrency and Parallelism</a></td></tr><tr><td align="right">12&nbsp;</td><td><a href="Macros.html" class="tocviewlink" data-pltdoc="x">Macros</a></td></tr><tr><td align="right">13&nbsp;</td><td><a href="input-and-output.html" class="tocviewlink" data-pltdoc="x">Input and Output</a></td></tr><tr><td align="right">14&nbsp;</td><td><a href="security.html" class="tocviewlink" data-pltdoc="x">Reflection and Security</a></td></tr><tr><td align="right">15&nbsp;</td><td><a href="os.html" class="tocviewlink" data-pltdoc="x">Operating System</a></td></tr><tr><td align="right">16&nbsp;</td><td><a href="memory.html" class="tocviewlink" data-pltdoc="x">Memory Management</a></td></tr><tr><td align="right">17&nbsp;</td><td><a href="unsafe.html" class="tocviewlink" data-pltdoc="x">Unsafe Operations</a></td></tr><tr><td align="right">18&nbsp;</td><td><a href="running.html" class="tocviewlink" data-pltdoc="x">Running Racket</a></td></tr><tr><td align="right"></td><td><a href="doc-bibliography.html" class="tocviewlink" data-pltdoc="x">Bibliography</a></td></tr><tr><td align="right"></td><td><a href="doc-index.html" class="tocviewlink" data-pltdoc="x">Index</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9660;</a></td><td>7&nbsp;</td><td><a href="mzlib_unit.html" class="tocviewlink" data-pltdoc="x">Units</a></td></tr></table><div class="tocviewsublistbottom" style="display: block;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">7.1&nbsp;</td><td><a href="creatingunits.html" class="tocviewlink" data-pltdoc="x">Creating Units</a></td></tr><tr><td align="right">7.2&nbsp;</td><td><a href="invokingunits.html" class="tocviewlink" data-pltdoc="x">Invoking Units</a></td></tr><tr><td align="right">7.3&nbsp;</td><td><a href="compoundunits.html" class="tocviewlink" data-pltdoc="x">Linking Units and Creating Compound Units</a></td></tr><tr><td align="right">7.4&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Inferred Linking</a></td></tr><tr><td align="right">7.5&nbsp;</td><td><a href="Generating_A_Unit_from_Context.html" class="tocviewlink" data-pltdoc="x">Generating A Unit from Context</a></td></tr><tr><td align="right">7.6&nbsp;</td><td><a href="Structural_Matching.html" class="tocviewlink" data-pltdoc="x">Structural Matching</a></td></tr><tr><td align="right">7.7&nbsp;</td><td><a href="define-sig-form.html" class="tocviewlink" data-pltdoc="x">Extending the Syntax of Signatures</a></td></tr><tr><td align="right">7.8&nbsp;</td><td><a href="Unit_Utilities.html" class="tocviewlink" data-pltdoc="x">Unit Utilities</a></td></tr><tr><td align="right">7.9&nbsp;</td><td><a href="unitcontracts.html" class="tocviewlink" data-pltdoc="x">Unit Contracts</a></td></tr><tr><td align="right">7.10&nbsp;</td><td><a href="single-unit.html" class="tocviewlink" data-pltdoc="x">Single-<wbr></wbr>Unit Modules</a></td></tr><tr><td align="right">7.11&nbsp;</td><td><a href="Single-Signature_Modules.html" class="tocviewlink" data-pltdoc="x">Single-<wbr></wbr>Signature Modules</a></td></tr><tr><td align="right">7.12&nbsp;</td><td><a href="Transformer_Helpers.html" class="tocviewlink" data-pltdoc="x">Transformer Helpers</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">在本页中：</div><table class="tocsublist" cellspacing="0"><tr><td><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._define-unit%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">define-<wbr></wbr>unit</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._compound-unit%2Finfer%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">compound-<wbr></wbr>unit/<span class="mywbr"> &nbsp;</span>infer</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._define-compound-unit%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">define-<wbr></wbr>compound-<wbr></wbr>unit</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._define-compound-unit%2Finfer%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">define-<wbr></wbr>compound-<wbr></wbr>unit/<span class="mywbr"> &nbsp;</span>infer</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._define-unit-binding%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">define-<wbr></wbr>unit-<wbr></wbr>binding</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._invoke-unit%2Finfer%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">invoke-<wbr></wbr>unit/<span class="mywbr"> &nbsp;</span>infer</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._define-values%2Finvoke-unit%2Finfer%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">define-<wbr></wbr>values/<span class="mywbr"> &nbsp;</span>invoke-<wbr></wbr>unit/<span class="mywbr"> &nbsp;</span>infer</span></span></a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="…搜索手册…" title="输入搜索字符串以搜索手册" onkeypress="return DoSearchKey(event, this, &quot;7.0.0.18&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;…搜索手册…&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;…搜索手册…&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="上至文档的顶层" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.0.0.18&quot;);">&#39030;&#23618;</a></span><span class="navright">&nbsp;&nbsp;<a href="compoundunits.html" title="后退至&quot;7.3 Linking Units and Creating Compound Units&quot;" data-pltdoc="x">&larr; &#21069;&#19968;&#39029;</a>&nbsp;&nbsp;<a href="mzlib_unit.html" title="上至&quot;7 Units&quot;" data-pltdoc="x">&#19978;&#19968;&#23618;</a>&nbsp;&nbsp;<a href="Generating_A_Unit_from_Context.html" title="前进至&quot;7.5 Generating A Unit from Context&quot;" data-pltdoc="x">&#21518;&#19968;&#39029; &rarr;</a></span>&nbsp;</div><h4 x-source-module="(lib &quot;scribblings/reference/reference.scrbl&quot;)" x-source-pkg="racket-doc" x-part-tag="&quot;linkinference&quot;">7.4<tt>&nbsp;</tt><a name="(part._linkinference)"></a>Inferred Linking</h4><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>&#35821;&#27861;</p></div></div><table cellspacing="0" cellpadding="0" class="RktBlk RForeground"><tr><td><span class="RktPn">(</span><a name="(form._((lib._racket/unit..rkt)._define-unit))"></a><span title="提供自：racket/unit、racket | 包：base"><span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._define-unit%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define-unit</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">unit-id</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._import%29%29" class="RktStxLink" data-pltdoc="x">import</a></span><span class="hspace">&nbsp;</span><span class="RktVar">tagged-sig-spec</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._export%29%29" class="RktStxLink" data-pltdoc="x">export</a></span><span class="hspace">&nbsp;</span><span class="RktVar">tagged-sig-spec</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">init-depends-decl</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">unit-body-expr-or-defn</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Binds <span class="RktVar">unit-id</span> to both a unit and static information about the
unit.</div></p><p>Evaluating a reference to a <span class="RktVar">unit-id</span> bound by
<span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._define-unit%29%29" class="RktStxLink" data-pltdoc="x">define-unit</a></span> produces a unit, just like evaluating an
<span class="RktSym">id</span> bound by <span class="RktPn">(</span><span class="RktSym"><a href="define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="stt"> </span><span class="RktSym">id</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._unit%29%29" class="RktStxLink" data-pltdoc="x">unit</a></span><span class="stt"> </span><span class="RktMeta"><a href="stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span>. In addition,
however, <span class="RktVar">unit-id</span> can be used in <span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._compound-unit%2Finfer%29%29" class="RktStxLink" data-pltdoc="x">compound-unit/infer</a></span>.
See <span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._unit%29%29" class="RktStxLink" data-pltdoc="x">unit</a></span> for information on <span class="RktVar">tagged-sig-spec</span>,
<span class="RktVar">init-depends-decl</span>, and <span class="RktVar">unit-body-expr-or-defn</span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>&#35821;&#27861;</p></div></div><table cellspacing="0" cellpadding="0" class="RktBlk RForeground"><tr><td><span class="RktPn">(</span><a name="(form._((lib._racket/unit..rkt)._compound-unit/infer))"></a><span title="提供自：racket/unit、racket | 包：base"><span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._compound-unit%2Finfer%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">compound-unit/infer</a></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._import%29%29" class="RktStxLink" data-pltdoc="x">import</a></span><span class="hspace">&nbsp;</span><span class="RktVar">tagged-infer-link-import</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._export%29%29" class="RktStxLink" data-pltdoc="x">export</a></span><span class="hspace">&nbsp;</span><span class="RktVar">tagged-infer-link-export</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._link%29%29" class="RktStxLink" data-pltdoc="x">link</a></span><span class="hspace">&nbsp;</span><span class="RktVar">infer-linkage-decl</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="specgrammar"><tr><td align="right" valign="baseline"><span class="RktVar">tagged-infer-link-import</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">tagged-sig-id</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktVar">link-id</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktVar">tagged-sig-id</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">tagged-infer-link-export</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._tag%29%29" class="RktStxLink" data-pltdoc="x">tag</a></span><span class="hspace">&nbsp;</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">infer-link-export</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">infer-link-export</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">infer-link-export</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">link-id</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">sig-id</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">infer-linkage-decl</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktVar">link-binding</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVar">unit-id</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVar">tagged-link-id</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">unit-id</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="compoundunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._compound-unit%29%29" class="RktStxLink" data-pltdoc="x">compound-unit</a></span>. Syntactically, the difference between
<span class="RktSym"><a href="compoundunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._compound-unit%29%29" class="RktStxLink" data-pltdoc="x">compound-unit</a></span> and <span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._compound-unit%2Finfer%29%29" class="RktStxLink" data-pltdoc="x">compound-unit/infer</a></span> is that the
<span class="RktSym">unit-expr</span> for a linked unit is replaced with a
<span class="RktVar">unit-id</span>, where a <span class="RktVar">unit-id</span> is bound by
<span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._define-unit%29%29" class="RktStxLink" data-pltdoc="x">define-unit</a></span> (or one of the other unit-binding forms that we
introduce later in this section). Furthermore, an import can name just
a <span class="RktVar">sig-id</span> without locally binding a <span class="RktVar">link-id</span>, and an
export can be based on a <span class="RktVar">sig-id</span> instead of a
<span class="RktVar">link-id</span>, and a declaration in the <span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._link%29%29" class="RktStxLink" data-pltdoc="x">link</a></span> clause can be
simply a <span class="RktVar">unit-id</span> with no specified exports or imports.</div></p><p>The <span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._compound-unit%2Finfer%29%29" class="RktStxLink" data-pltdoc="x">compound-unit/infer</a></span> form expands to
<span class="RktSym"><a href="compoundunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._compound-unit%29%29" class="RktStxLink" data-pltdoc="x">compound-unit</a></span> by adding <span class="RktSym">sig-ids</span> as needed to
the <span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._import%29%29" class="RktStxLink" data-pltdoc="x">import</a></span> clause, by replacing <span class="RktVar">sig-id</span>s in the
<span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._export%29%29" class="RktStxLink" data-pltdoc="x">export</a></span> clause by <span class="RktVar">link-id</span>s, and by completing
the declarations of the <span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._link%29%29" class="RktStxLink" data-pltdoc="x">link</a></span> clause. This completion is based
on static information associated with each
<span class="RktVar">unit-id</span>. Links and exports can be inferred when all
signatures exported by the linked units are distinct from each other
and from all imported signatures, and when all imported signatures are
distinct. Two signatures are <span style="font-family: 楷体">distinct</span> only if they
share no ancestor through <span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._extends%29%29" class="RktStxLink" data-pltdoc="x">extends</a></span>.</p><p>The long form of a <span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._link%29%29" class="RktStxLink" data-pltdoc="x">link</a></span> declaration can be used to resolve
ambiguity by giving names to some of a unit&rsquo;s exports and supplying
specific bindings for some of a unit&rsquo;s imports. The long form need not
name all of a unit&rsquo;s exports or supply all of a unit&rsquo;s imports if the
remaining parts can be inferred.</p><p>When a unit declares initialization dependencies,
<span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._compound-unit%2Finfer%29%29" class="RktStxLink" data-pltdoc="x">compound-unit/infer</a></span> checks that the <span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._link%29%29" class="RktStxLink" data-pltdoc="x">link</a></span> declaration
is consistent with those dependencies, and it reports a syntax error if
not.</p><p>Like <span class="RktSym"><a href="compoundunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._compound-unit%29%29" class="RktStxLink" data-pltdoc="x">compound-unit</a></span>, the <span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._compound-unit%2Finfer%29%29" class="RktStxLink" data-pltdoc="x">compound-unit/infer</a></span> form
produces a (compound) unit without statically binding information
about the result unit&rsquo;s imports and exports. That is,
<span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._compound-unit%2Finfer%29%29" class="RktStxLink" data-pltdoc="x">compound-unit/infer</a></span> consumes static information, but it does
not generate it. Two additional forms,
<span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._define-compound-unit%29%29" class="RktStxLink" data-pltdoc="x">define-compound-unit</a></span> and
<span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._define-compound-unit%2Finfer%29%29" class="RktStxLink" data-pltdoc="x">define-compound-unit/infer</a></span>, generate static information
(where the former does not consume static information).</p><p class="SHistory">&#20462;&#25913;&#20110;package <span class="stt">base</span>&#30340;6.1.1.8&#29256;&#26412;&#65306;Added static checking of the <span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._link%29%29" class="RktStxLink" data-pltdoc="x">link</a></span>
clause with respect to declared
initialization dependencies.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>&#35821;&#27861;</p></div></div><table cellspacing="0" cellpadding="0" class="RktBlk RForeground"><tr><td><span class="RktPn">(</span><a name="(form._((lib._racket/unit..rkt)._define-compound-unit))"></a><span title="提供自：racket/unit、racket | 包：base"><span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._define-compound-unit%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define-compound-unit</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">id</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._import%29%29" class="RktStxLink" data-pltdoc="x">import</a></span><span class="hspace">&nbsp;</span><span class="RktVar">link-binding</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._export%29%29" class="RktStxLink" data-pltdoc="x">export</a></span><span class="hspace">&nbsp;</span><span class="RktVar">tagged-link-id</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._link%29%29" class="RktStxLink" data-pltdoc="x">link</a></span><span class="hspace">&nbsp;</span><span class="RktVar">linkage-decl</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="compoundunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._compound-unit%29%29" class="RktStxLink" data-pltdoc="x">compound-unit</a></span>, but binds static information about the
compound unit like <span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._define-unit%29%29" class="RktStxLink" data-pltdoc="x">define-unit</a></span>, including the propagation of
initialization-dependency information (on remaining inports) from the
linked units.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>&#35821;&#27861;</p></div></div><table cellspacing="0" cellpadding="0" class="RktBlk RForeground"><tr><td><span class="RktPn">(</span><a name="(form._((lib._racket/unit..rkt)._define-compound-unit/infer))"></a><span title="提供自：racket/unit、racket | 包：base"><span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._define-compound-unit%2Finfer%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define-compound-unit/infer</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">id</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._import%29%29" class="RktStxLink" data-pltdoc="x">import</a></span><span class="hspace">&nbsp;</span><span class="RktVar">link-binding</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._export%29%29" class="RktStxLink" data-pltdoc="x">export</a></span><span class="hspace">&nbsp;</span><span class="RktVar">tagged-infer-link-export</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._link%29%29" class="RktStxLink" data-pltdoc="x">link</a></span><span class="hspace">&nbsp;</span><span class="RktVar">infer-linkage-decl</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._compound-unit%2Finfer%29%29" class="RktStxLink" data-pltdoc="x">compound-unit/infer</a></span>, but binds static information about
the compound unit like <span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._define-compound-unit%29%29" class="RktStxLink" data-pltdoc="x">define-compound-unit</a></span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>&#35821;&#27861;</p></div></div><table cellspacing="0" cellpadding="0" class="RktBlk RForeground"><tr><td><span class="RktPn">(</span><a name="(form._((lib._racket/unit..rkt)._define-unit-binding))"></a><span title="提供自：racket/unit、racket | 包：base"><span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._define-unit-binding%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define-unit-binding</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">unit-id</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">unit-expr</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._import%29%29" class="RktStxLink" data-pltdoc="x">import</a></span><span class="hspace">&nbsp;</span><span class="RktVar">tagged-sig-spec</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._export%29%29" class="RktStxLink" data-pltdoc="x">export</a></span><span class="hspace">&nbsp;</span><span class="RktVar">tagged-sig-spec</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">init-depends-decl</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._define-unit%29%29" class="RktStxLink" data-pltdoc="x">define-unit</a></span>, but the unit implementation is determined
from an existing unit produced by <span class="RktVar">unit-expr</span>. The imports and
exports of the unit produced by <span class="RktVar">unit-expr</span> must be consistent
with the declared imports and exports, otherwise the
<span class="RktSym"><a href="exns.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._exn~3afail~3acontract%29%29" class="RktValLink" data-pltdoc="x">exn:fail:contract</a></span> exception is raised when the <span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._define-unit-binding%29%29" class="RktStxLink" data-pltdoc="x">define-unit-binding</a></span>
form is evaluated.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>&#35821;&#27861;</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._racket/unit..rkt)._invoke-unit/infer))"></a><span title="提供自：racket/unit、racket | 包：base"><span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._invoke-unit%2Finfer%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">invoke-unit/infer</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">unit-spec</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="specgrammar"><tr><td align="right" valign="baseline"><span class="RktVar">unit-spec</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">unit-id</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._link%29%29" class="RktStxLink" data-pltdoc="x">link</a></span><span class="hspace">&nbsp;</span><span class="RktVar">link-unit-id</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="invokingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._invoke-unit%29%29" class="RktStxLink" data-pltdoc="x">invoke-unit</a></span>, but uses static information associated with
<span class="RktVar">unit-id</span> to infer which imports must be assembled from the
current context.  If given a link form containing multiple
<span class="RktVar">link-unit-id</span>s, then the units are first linked via
<span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._define-compound-unit%2Finfer%29%29" class="RktStxLink" data-pltdoc="x">define-compound-unit/infer</a></span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>&#35821;&#27861;</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._racket/unit..rkt)._define-values/invoke-unit/infer))"></a><span title="提供自：racket/unit、racket | 包：base"><span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._define-values%2Finvoke-unit%2Finfer%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define-values/invoke-unit/infer</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-exports</span><span class="hspace">&nbsp;</span><span class="RktVar">unit-spec</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="specgrammar"><tr><td align="right" valign="baseline"><span class="RktVar">maybe-exports</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._export%29%29" class="RktStxLink" data-pltdoc="x">export</a></span><span class="hspace">&nbsp;</span><span class="RktVar">tagged-sig-spec</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">unit-spec</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">unit-id</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktSym"><a href="creatingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._link%29%29" class="RktStxLink" data-pltdoc="x">link</a></span><span class="hspace">&nbsp;</span><span class="RktVar">link-unit-id</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="invokingunits.html#%28form._%28%28lib._racket%2Funit..rkt%29._define-values%2Finvoke-unit%29%29" class="RktStxLink" data-pltdoc="x">define-values/invoke-unit</a></span>, but uses static information
associated with <span class="RktVar">unit-id</span> to infer which imports must be
assembled from the current context and which exports should be bound
by the definition.  If given a link form containing multiple
<span class="RktVar">link-unit-id</span>s, then the units are first linked via
<span class="RktSym"><a href="#%28form._%28%28lib._racket%2Funit..rkt%29._define-compound-unit%2Finfer%29%29" class="RktStxLink" data-pltdoc="x">define-compound-unit/infer</a></span>.</div></p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="…搜索手册…" title="输入搜索字符串以搜索手册" onkeypress="return DoSearchKey(event, this, &quot;7.0.0.18&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;…搜索手册…&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;…搜索手册…&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="上至文档的顶层" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.0.0.18&quot;);">&#39030;&#23618;</a></span><span class="navright">&nbsp;&nbsp;<a href="compoundunits.html" title="后退至&quot;7.3 Linking Units and Creating Compound Units&quot;" data-pltdoc="x">&larr; &#21069;&#19968;&#39029;</a>&nbsp;&nbsp;<a href="mzlib_unit.html" title="上至&quot;7 Units&quot;" data-pltdoc="x">&#19978;&#19968;&#23618;</a>&nbsp;&nbsp;<a href="Generating_A_Unit_from_Context.html" title="前进至&quot;7.5 Generating A Unit from Context&quot;" data-pltdoc="x">&#21518;&#19968;&#39029; &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>