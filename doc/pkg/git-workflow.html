<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>6&nbsp;Developing Packages with Git</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Package Management in Racket</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="getting-started.html" class="tocviewlink" data-pltdoc="x">Getting Started with Packages</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Package_Concepts.html" class="tocviewlink" data-pltdoc="x">Package Concepts</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="cmdline.html" class="tocviewlink" data-pltdoc="x">Using <span class="stt">raco pkg</span></a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="metadata.html" class="tocviewlink" data-pltdoc="x">Package Metadata</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="strip.html" class="tocviewlink" data-pltdoc="x">Source, Binary, and Built Packages</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Developing Packages with Git</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="apis.html" class="tocviewlink" data-pltdoc="x">Package APIs</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="catalog-protocol.html" class="tocviewlink" data-pltdoc="x">Package Catalog Protocol</a></td></tr><tr><td align="right">9&nbsp;</td><td><a href="PLaneT_Compatibility.html" class="tocviewlink" data-pltdoc="x"><span class="planetName">PLane<span class="mywbr"> &nbsp;</span>T</span> Compatibility</a></td></tr><tr><td align="right">10&nbsp;</td><td><a href="FAQ.html" class="tocviewlink" data-pltdoc="x">FAQ</a></td></tr><tr><td align="right">11&nbsp;</td><td><a href="Future_Plans.html" class="tocviewlink" data-pltdoc="x">Future Plans</a></td></tr><tr><td align="right">12&nbsp;</td><td><a href="implementation.html" class="tocviewlink" data-pltdoc="x">How Package Installation and Distribution Works</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>6&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Developing Packages with Git</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">6.1&nbsp;</td><td><a href="#%28part._.Linking_a_.Git_.Checkout_as_a_.Directory%29" class="tocviewlink" data-pltdoc="x">Linking a Git Checkout as a Directory</a></td></tr><tr><td align="right">6.2&nbsp;</td><td><a href="#%28part._clone-link%29" class="tocviewlink" data-pltdoc="x">Linking a Git Checkout as a Clone</a></td></tr><tr><td align="right">6.3&nbsp;</td><td><a href="#%28part._.Interactions_.Between_git_and_raco_pkg%29" class="tocviewlink" data-pltdoc="x">Interactions Between <span class="stt">git</span> and <span class="stt">raco pkg</span></a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">在本页中：</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">6.1<tt>&nbsp;</tt></span><a href="#%28part._.Linking_a_.Git_.Checkout_as_a_.Directory%29" class="tocsubseclink" data-pltdoc="x">Linking a Git Checkout as a Directory</a></td></tr><tr><td><span class="tocsublinknumber">6.2<tt>&nbsp;</tt></span><a href="#%28part._clone-link%29" class="tocsubseclink" data-pltdoc="x">Linking a Git Checkout as a Clone</a></td></tr><tr><td><span class="tocsublinknumber">6.3<tt>&nbsp;</tt></span><a href="#%28part._.Interactions_.Between_git_and_raco_pkg%29" class="tocsubseclink" data-pltdoc="x">Interactions Between <span class="stt">git</span> and <span class="stt">raco pkg</span></a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">7.0.0.18</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="…搜索手册…" title="输入搜索字符串以搜索手册" onkeypress="return DoSearchKey(event, this, &quot;7.0.0.18&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;…搜索手册…&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;…搜索手册…&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="上至文档的顶层" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.0.0.18&quot;);">&#39030;&#23618;</a></span><span class="navright">&nbsp;&nbsp;<a href="strip.html" title="后退至&quot;5 Source, Binary, and Built Packages&quot;" data-pltdoc="x">&larr; &#21069;&#19968;&#39029;</a>&nbsp;&nbsp;<a href="index.html" title="上至&quot;Package Management in Racket&quot;" data-pltdoc="x">&#19978;&#19968;&#23618;</a>&nbsp;&nbsp;<a href="apis.html" title="前进至&quot;7 Package APIs&quot;" data-pltdoc="x">&#21518;&#19968;&#39029; &rarr;</a></span>&nbsp;</div><h3 x-source-module="(lib &quot;pkg/scribblings/pkg.scrbl&quot;)" x-source-pkg="racket-doc" x-part-tag="&quot;git-workflow&quot;">6<tt>&nbsp;</tt><a name="(part._git-workflow)"></a>Developing Packages with Git</h3><p>When a Git repository is specified as a package source, then a copy of
the repository content is installed as the package
implementation. That installation mode is designed for package
consumers, who normally use a package without modifying it. The
installed copy of the package is unsuitable for development by the
package author, however, since the installation is not a full clone of
the Git repository. The Racket package manager provides different
installation modes to support package authors who work with Git
repository clones.</p><h4 x-source-module="(lib &quot;pkg/scribblings/pkg.scrbl&quot;)" x-source-pkg="racket-doc" x-part-tag="&quot;Linking_a_Git_Checkout_as_a_Directory&quot;">6.1<tt>&nbsp;</tt><a name="(part._.Linking_a_.Git_.Checkout_as_a_.Directory)"></a>Linking a Git Checkout as a Directory</h4><p>Since a Git repository checkout is a directory, it can be linked as a
package as described in <a href="getting-started.html#%28part._working-new-pkgs%29" data-pltdoc="x">Linking and Developing New Packages</a>. In that case, any
modifications made locally take effect immediately for the package
installation, including any updates from a <span class="stt">git pull</span>. The
developer must explicitly pull any remote updates to the repository,
however, including when the updates are needed to satisfy the
requirements of dependent packages.</p><p>In the following section, we describe an alternative that makes
<a href="cmdline.html#%28part._raco-pkg-update%29" class="plainlink" data-pltdoc="x"><span class="stt">raco pkg update</span></a> aware of the checkout directory&rsquo;s status as a
repository clone. Furthermore, a directory-linked package can be
promoted to a clone-linked package with <a href="cmdline.html#%28part._raco-pkg-update%29" class="plainlink" data-pltdoc="x"><span class="stt">raco pkg update</span></a>.</p><h4 x-source-module="(lib &quot;pkg/scribblings/pkg.scrbl&quot;)" x-source-pkg="racket-doc" x-part-tag="&quot;clone-link&quot;">6.2<tt>&nbsp;</tt><a name="(part._clone-link)"></a>Linking a Git Checkout as a Clone</h4><p>When a package is installed with</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">raco pkg install</span><span class="stt"> --clone </span><span class="sroman">&#8249;<span style="font-family: 楷体">dir</span>&#8250;</span><span class="stt"> </span><span class="sroman">&#8249;<span style="font-family: 楷体">git-pkg-source</span>&#8250;</span></p><p>then instead of installing the package as a mere copy of the
repository source, the package is installed by creating a Git clone of
<span class="sroman">&#8249;<span style="font-family: 楷体">git-pkg-source</span>&#8250;</span> as <span class="sroman">&#8249;<span style="font-family: 楷体">dir</span>&#8250;</span>. The clone&rsquo;s checkout is
linked in the same way as a directory, but unlike a plain directory
link, the Racket package manager keeps track of the repository
connection. The <span class="sroman">&#8249;<span style="font-family: 楷体">git-pkg-source</span>&#8250;</span> must be a Git or GitHub
package source, or it must be a package name that the catalog maps to
a Git or GitHub package source; if the source URL includes a fragment,
it must name a branch or tag (as opposed to a raw commit).</p><p>When the repository at <span class="sroman">&#8249;<span style="font-family: 楷体">git-pkg-source</span>&#8250;</span> is changed so that the
source has a new checksum, then <a href="cmdline.html#%28part._raco-pkg-update%29" class="plainlink" data-pltdoc="x"><span class="stt">raco pkg update</span></a> for the package pulls
commits from the repository to the local clone. In other words,
<a href="cmdline.html#%28part._raco-pkg-update%29" class="plainlink" data-pltdoc="x"><span class="stt">raco pkg update</span></a> works as an alternative to <span class="stt">git pull --ff-only</span>
to pull updates for the package. Furthermore, <a href="cmdline.html#%28part._raco-pkg-update%29" class="plainlink" data-pltdoc="x"><span class="stt">raco pkg update</span></a> can
pull updates to local package repositories when checking dependencies.
For example, <span class="stt">raco pkg update</span><span class="stt"> --all</span> pulls updates for all
linked package repositories.</p><p>A <a href="Package_Concepts.html#%28tech._package._source%29" class="techoutside" data-pltdoc="x"><span class="techinside">package source</span></a> provided with <span class="nobreak"><span class="stt">--clone</span></span> can include a
branch and/or path into the repository. The branch specification
affects the branch used for the initial checkout, while a non-empty
path causes a subdirectory of the checkout to be linked for the
package.</p><p>Suppose that a developer works with a large number of packages and
develops only a few of them. The intended workflow is as follows:</p><ul><li><p>Install all the relevant packages with <a href="cmdline.html#%28part._raco-pkg-install%29" class="plainlink" data-pltdoc="x"><span class="stt">raco pkg install</span></a>.</p></li><li><p>For each package to be developed out of a particular Git
repository named by <span class="sroman">&#8249;<span style="font-family: 楷体">pkg-name</span>&#8250;</span>, update the installation with</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">raco pkg update</span><span class="stt"> --clone </span><span class="sroman">&#8249;<span style="font-family: 楷体">dir</span>&#8250;</span><span class="stt"> </span><span class="sroman">&#8249;<span style="font-family: 楷体">pkg-name</span>&#8250;</span></p><p>which discards the original installation of the package and replaces
it with a local clone as <span class="sroman">&#8249;<span style="font-family: 楷体">dir</span>&#8250;</span>.</p><p>As a convenience, when <span class="sroman">&#8249;<span style="font-family: 楷体">git-pkg-source</span>&#8250;</span> and the last element
of <span class="sroman">&#8249;<span style="font-family: 楷体">dir</span>&#8250;</span> are the same, then <span class="sroman">&#8249;<span style="font-family: 楷体">pkg-name</span>&#8250;</span> can be
omitted. Put another way, the argument to <span class="nobreak"><span class="stt">--clone</span></span> can be a
path to <span class="sroman">&#8249;<span style="font-family: 楷体">pkg-name</span>&#8250;</span>:</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">raco pkg update</span><span class="stt"> --clone </span><span class="sroman">&#8249;<span style="font-family: 楷体">path-to</span>&#8250;</span><span class="stt">/</span><span class="sroman">&#8249;<span style="font-family: 楷体">pkg-name</span>&#8250;</span></p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>As a further convenience, when building from scratch
from the main Racket source repository, the Git configuration
ignores a top-level <span class="stt">"extra-pkgs"</span> directory. The directory
is intended to be used as a target for <span class="nobreak"><span class="stt">--clone</span></span>:</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">raco pkg update</span><span class="stt"> --clone extra-pkgs/</span><span class="sroman">&#8249;<span style="font-family: 楷体">pkg-name</span>&#8250;</span></p><p>which creates the <span class="stt">"extra-pkgs"</span> subdirectory if it doesn&rsquo;t exist.</p></blockquote></blockquote></blockquote></li><li><p>If a package&rsquo;s current installation is not drawn from a Git
repository (e.g., it&rsquo;s drawn from a catalog of built packages for a
distribution or snapshot), but <span class="sroman">&#8249;<span style="font-family: 楷体">catalog</span>&#8250;</span> maps the package
name to the right Git repository, then combine <span class="nobreak"><span class="stt">--clone</span></span> with
<span class="nobreak"><span class="stt">--lookup</span></span> and <span class="nobreak"><span class="stt">--catalog</span></span>:</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">raco pkg update</span><span class="stt"> --lookup --catalog </span><span class="sroman">&#8249;<span style="font-family: 楷体">catalog</span>&#8250;</span><span class="stt"> --clone </span><span class="sroman">&#8249;<span style="font-family: 楷体">path-to</span>&#8250;</span><span class="stt">/</span><span class="sroman">&#8249;<span style="font-family: 楷体">pkg-name</span>&#8250;</span></p><p>A suitable <span class="sroman">&#8249;<span style="font-family: 楷体">catalog</span>&#8250;</span> might be <a href="https://pkgs.racket-lang.org"><span class="url">https://pkgs.racket-lang.org</span></a>.</p></li><li><p>A newly cloned package will have the specified (or existing
installation&rsquo;s) repository as its Git <span class="stt">origin</span>. If you want to
push and pull updates from a different repository&#8212;<wbr></wbr>for instance,
your own fork of the package source&#8212;<wbr></wbr>then use <span class="stt">git</span> commands
to add or change the <span class="stt">origin</span> of your clone to the other
repository. For example, the command</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">git remote set-url origin </span><span class="sroman">&#8249;<span style="font-family: 楷体">url-of-other-repo</span>&#8250;</span></p><p>in the clone&rsquo;s directory causes <span class="stt">git pull</span> and <span class="stt">git push</span>
to pull and push to the given <span class="sroman">&#8249;<span style="font-family: 楷体">url-of-other-repo</span>&#8250;</span>.</p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>You can preserve the clone&rsquo;s connection to its central
repository by setting an <span class="stt">upstream</span> remote, e.g. <span class="stt">git</span><span class="stt">
</span><span class="stt">remote add upstream </span><span class="sroman">&#8249;<span style="font-family: 楷体">url-of-central-repo</span>&#8250;</span>. This gives you
the option to periodically pull in commits from the central
repository with <span class="stt">git pull --ff-only upstream master</span>.</p></blockquote></blockquote></blockquote><p>Alternatively, use <span class="stt">git</span> to clone the target <span class="sroman">&#8249;<span style="font-family: 楷体">url</span>&#8250;</span>
first, and then supply the local clone&rsquo;s path as <span class="sroman">&#8249;<span style="font-family: 楷体">dir</span>&#8250;</span> in</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">raco pkg update</span><span class="stt"> --clone </span><span class="sroman">&#8249;<span style="font-family: 楷体">dir</span>&#8250;</span><span class="stt"> </span><span class="sroman">&#8249;<span style="font-family: 楷体">pkg-name</span>&#8250;</span></p><p>Either way, when <span class="stt">raco pkg update</span> pulls updates to the clone, it
will still pull them from the repository corresponding to
<span class="sroman">&#8249;<span style="font-family: 楷体">pkg-name</span>&#8250;</span>&rsquo;s old source, and not from the <span class="stt">git remote</span>
<span class="sroman">&#8249;<span style="font-family: 楷体">url</span>&#8250;</span>. Usually, that&rsquo;s what package developers want; when
they&rsquo;re not actively modifying a package, other developers&rsquo; updates
should be pulled from the package&rsquo;s main repository. In case where
<span class="sroman">&#8249;<span style="font-family: 楷体">url</span>&#8250;</span> is the preferred source of updates for
<span class="stt">raco pkg update</span>, use <span class="sroman">&#8249;<span style="font-family: 楷体">url</span>&#8250;</span> in</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">raco pkg update</span><span class="stt"> --clone </span><span class="sroman">&#8249;<span style="font-family: 楷体">dir</span>&#8250;</span><span class="stt"> </span><span class="sroman">&#8249;<span style="font-family: 楷体">url</span>&#8250;</span></p><p>Beware, however, that <span class="stt">raco pkg update</span> may be less able to detect
repository sharing among multiple packages (and keep the package
installations consistently associated with a particular clone)
when an alternative <span class="sroman">&#8249;<span style="font-family: 楷体">url</span>&#8250;</span> is provided.</p></li><li><p>Manage changes to each of the developed packages in the usual
way with <span class="stt">git</span> tools, but <a href="cmdline.html#%28part._raco-pkg-update%29" class="plainlink" data-pltdoc="x"><span class="stt">raco pkg update</span></a> is also available
for updates, including mass updates.</p></li></ul><h4 x-source-module="(lib &quot;pkg/scribblings/pkg.scrbl&quot;)" x-source-pkg="racket-doc" x-part-tag="&quot;Interactions_Between_git_and_raco_pkg&quot;">6.3<tt>&nbsp;</tt><a name="(part._.Interactions_.Between_git_and_raco_pkg)"></a>Interactions Between <span class="stt">git</span> and <span class="stt">raco pkg</span></h4><p>The <span class="stt">git</span> and <span class="stt">raco pkg</span> tools interact in specific
ways:</p><ul><li><p>With the link-establishing</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">raco pkg install</span><span class="stt"> --clone </span><span class="sroman">&#8249;<span style="font-family: 楷体">dir</span>&#8250;</span><span class="stt"> </span><span class="sroman">&#8249;<span style="font-family: 楷体">git-pkg-source</span>&#8250;</span></p><p>or the same for <a href="cmdline.html#%28part._raco-pkg-update%29" class="plainlink" data-pltdoc="x"><span class="stt">raco pkg update</span></a>, if a local repository exists
already as <span class="sroman">&#8249;<span style="font-family: 楷体">dir</span>&#8250;</span>, then it is left in place and any new
commits are fetched from <span class="sroman">&#8249;<span style="font-family: 楷体">git-pkg-source</span>&#8250;</span>. The package
manager does not attempt to check whether a pre-existing
<span class="sroman">&#8249;<span style="font-family: 楷体">dir</span>&#8250;</span> is consistent with <span class="sroman">&#8249;<span style="font-family: 楷体">git-pkg-source</span>&#8250;</span>; it
simply starts fetching new commits to <span class="sroman">&#8249;<span style="font-family: 楷体">dir</span>&#8250;</span>, and a
later <span class="stt">git pull --ff-only</span> will detect any mismatch.</p><p>Multiple <span class="sroman">&#8249;<span style="font-family: 楷体">git-pkg-source</span>&#8250;</span>s can be provided to
<a href="cmdline.html#%28part._raco-pkg-install%29" class="plainlink" data-pltdoc="x"><span class="stt">raco pkg install</span></a>, which makes sense when multiple packages
are sourced from the same repository and can therefore share
<span class="sroman">&#8249;<span style="font-family: 楷体">dir</span>&#8250;</span>.  Whether through a single <span class="stt">raco pkg</span> use or
multiple uses with the same <span class="stt">--clone </span><span class="sroman">&#8249;<span style="font-family: 楷体">dir</span>&#8250;</span>,
packages from the same repository should be linked from the
same local clone (assuming that they are in the same repository
because they should be modified together). The package system
does not inherently require clone sharing among the packages,
but since non-sharing or inconsistent installation modes could
be confusing, <a href="cmdline.html#%28part._raco-pkg-install%29" class="plainlink" data-pltdoc="x"><span class="stt">raco pkg install</span></a> and <a href="cmdline.html#%28part._raco-pkg-update%29" class="plainlink" data-pltdoc="x"><span class="stt">raco pkg update</span></a>
report non-sharing or inconsistent installations. In typical cases,
the default <span class="nobreak"><span class="stt">--multi-clone</span></span><span class="stt"> ask</span> mode can automatically
fix inconsistencies.</p></li><li><p>When pulling changes to repositories that have local copies,
<a href="cmdline.html#%28part._raco-pkg-update%29" class="plainlink" data-pltdoc="x"><span class="stt">raco pkg update</span></a> pulls changes with the equivalent of <span class="stt">git
pull --ff-only</span> by default. Supplying <span class="nobreak"><span class="stt">--pull</span></span><span class="stt"> rebase</span>
pulls changes with the equivalent of <span class="stt">git pull --rebase</span>, instead.
Supplying <span class="nobreak"><span class="stt">--pull</span></span><span class="stt"> try</span> attempts to pull with <span class="stt">git
pull --ff-only</span>, but failure is ignored.</p></li><li><p>When <a href="cmdline.html#%28part._raco-pkg-update%29" class="plainlink" data-pltdoc="x"><span class="stt">raco pkg update</span></a> is given a specific commit as the target
of the update, it uses the equivalent of <span class="stt">git merge --ff-only</span><span class="stt">
</span><span class="sroman">&#8249;<span style="font-family: 楷体">checksum</span>&#8250;</span> or <span class="stt">git merge --rebase</span><span class="stt">
</span><span class="sroman">&#8249;<span style="font-family: 楷体">checksum</span>&#8250;</span>. This approach is intended to preserve any
changes to the package made locally, but it implies that the
package cannot be &ldquo;downgraded&rdquo; to a older commit simply by
specifying the commit for <a href="cmdline.html#%28part._raco-pkg-update%29" class="plainlink" data-pltdoc="x"><span class="stt">raco pkg update</span></a>; any newer commits
that are already in the local repository will be preserved.</p></li><li><p>The installed-package database records the most recent commit
pulled from the source repository after each installation or
update. The current commit in the repository checkout is
consulted only for the purposes of merging onto pulled
commits. Thus, after pushing repository changes with <span class="stt">git
push</span>, a <a href="cmdline.html#%28part._raco-pkg-update%29" class="plainlink" data-pltdoc="x"><span class="stt">raco pkg update</span></a> makes sense to synchronize the
package-installation database with the remote repository state
(which is then the same as the local repository state).</p></li><li><p>When checking a <a href="cmdline.html#%28part._raco-pkg-install%29" class="plainlink" data-pltdoc="x"><span class="stt">raco pkg install</span></a> or <a href="cmdline.html#%28part._raco-pkg-update%29" class="plainlink" data-pltdoc="x"><span class="stt">raco pkg update</span></a>
request for dependencies and collisions, the clone directory&rsquo;s
content is used directly only if the current checkout includes
the target commit.</p><p>Otherwise, commits are first fetched with <span class="stt">git fetch</span>, and
an additional local clone is created in a temporary directory.
If the overall installation or update is deemed to be
successful with respect to remote commits (not necessarily the
current commit in each local repository) in that copy, then an
update to the linked repository checkout proceeds. Finally,
after all checkouts succeed, other package installations and
updates are completed and recorded. If a checkout fails (e.g.,
due to a conflict or uncommitted change), then the repository
checkout is left in a failed state, but all package actions are
otherwise canceled.</p></li><li><p>Removing a package with <a href="cmdline.html#%28part._raco-pkg-remove%29" class="plainlink" data-pltdoc="x"><span class="stt">raco pkg remove</span></a> leaves the
repository checkout intact while removing the package link.</p></li></ul><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="…搜索手册…" title="输入搜索字符串以搜索手册" onkeypress="return DoSearchKey(event, this, &quot;7.0.0.18&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;…搜索手册…&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;…搜索手册…&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="上至文档的顶层" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.0.0.18&quot;);">&#39030;&#23618;</a></span><span class="navright">&nbsp;&nbsp;<a href="strip.html" title="后退至&quot;5 Source, Binary, and Built Packages&quot;" data-pltdoc="x">&larr; &#21069;&#19968;&#39029;</a>&nbsp;&nbsp;<a href="index.html" title="上至&quot;Package Management in Racket&quot;" data-pltdoc="x">&#19978;&#19968;&#23618;</a>&nbsp;&nbsp;<a href="apis.html" title="前进至&quot;7 Package APIs&quot;" data-pltdoc="x">&#21518;&#19968;&#39029; &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>