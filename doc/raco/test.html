<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>13&nbsp;raco test: Run tests</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x"><span class="stt">raco</span>:<span class="mywbr"> &nbsp;</span> Racket Command-<wbr></wbr>Line Tools</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="make.html" class="tocviewlink" data-pltdoc="x"><span class="stt">raco make</span>:<span class="mywbr"> &nbsp;</span> Compiling Source to Bytecode</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="exe.html" class="tocviewlink" data-pltdoc="x"><span class="stt">raco exe</span>:<span class="mywbr"> &nbsp;</span> Creating Stand-<wbr></wbr>Alone Executables</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="exe-dist.html" class="tocviewlink" data-pltdoc="x"><span class="stt">raco distribute</span>:<span class="mywbr"> &nbsp;</span> Sharing Stand-<wbr></wbr>Alone Executables</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="planet.html" class="tocviewlink" data-pltdoc="x"><span class="stt">raco planet</span>:<span class="mywbr"> &nbsp;</span> Automatic Package Distribution</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="pkg.html" class="tocviewlink" data-pltdoc="x"><span class="stt">raco pkg</span>:<span class="mywbr"> &nbsp;</span> Package Management</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="setup.html" class="tocviewlink" data-pltdoc="x"><span class="stt">raco setup</span>:<span class="mywbr"> &nbsp;</span> Installation Management</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="decompile.html" class="tocviewlink" data-pltdoc="x"><span class="stt">raco decompile</span>:<span class="mywbr"> &nbsp;</span> Decompiling Bytecode</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="demod.html" class="tocviewlink" data-pltdoc="x"><span class="stt">raco demod</span>:<span class="mywbr"> &nbsp;</span> Demodularizing Programs</a></td></tr><tr><td align="right">9&nbsp;</td><td><a href="link.html" class="tocviewlink" data-pltdoc="x"><span class="stt">raco link</span>:<span class="mywbr"> &nbsp;</span> Library Collection Links</a></td></tr><tr><td align="right">10&nbsp;</td><td><a href="plt.html" class="tocviewlink" data-pltdoc="x"><span class="stt">raco pack</span>:<span class="mywbr"> &nbsp;</span> Packing Library Collections</a></td></tr><tr><td align="right">11&nbsp;</td><td><a href="unpack.html" class="tocviewlink" data-pltdoc="x"><span class="stt">raco unpack</span>:<span class="mywbr"> &nbsp;</span> Unpacking Library Collections</a></td></tr><tr><td align="right">12&nbsp;</td><td><a href="ctool.html" class="tocviewlink" data-pltdoc="x"><span class="stt">raco ctool</span>:<span class="mywbr"> &nbsp;</span> Working with C Code</a></td></tr><tr><td align="right">13&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x"><span class="stt">raco test</span>:<span class="mywbr"> &nbsp;</span> Run tests</a></td></tr><tr><td align="right">14&nbsp;</td><td><a href="docs.html" class="tocviewlink" data-pltdoc="x"><span class="stt">raco docs</span>:<span class="mywbr"> &nbsp;</span> Documentation Search</a></td></tr><tr><td align="right">15&nbsp;</td><td><a href="expand.html" class="tocviewlink" data-pltdoc="x"><span class="stt">raco expand</span>:<span class="mywbr"> &nbsp;</span> Macro Expansion</a></td></tr><tr><td align="right">16&nbsp;</td><td><a href="read.html" class="tocviewlink" data-pltdoc="x"><span class="stt">raco read</span>:<span class="mywbr"> &nbsp;</span> Reading and Pretty-<wbr></wbr>Printing</a></td></tr><tr><td align="right">17&nbsp;</td><td><a href="scribble.html" class="tocviewlink" data-pltdoc="x"><span class="stt">raco scribble</span>:<span class="mywbr"> &nbsp;</span> Building Documentation</a></td></tr><tr><td align="right">18&nbsp;</td><td><a href="command.html" class="tocviewlink" data-pltdoc="x">Adding a <span class="stt">raco</span> Command</a></td></tr><tr><td align="right">19&nbsp;</td><td><a href="config-file.html" class="tocviewlink" data-pltdoc="x">Installation Configuration and Search Paths</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>13&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x"><span class="stt">raco test</span>:<span class="mywbr"> &nbsp;</span> Run tests</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">13.1&nbsp;</td><td><a href="#%28part._test-config%29" class="tocviewlink" data-pltdoc="x">Test Configuration by Submodule</a></td></tr><tr><td align="right">13.2&nbsp;</td><td><a href="#%28part._test-config-info%29" class="tocviewlink" data-pltdoc="x">Test Configuration by <span class="stt">"info.rkt"</span></a></td></tr><tr><td align="right">13.3&nbsp;</td><td><a href="#%28part._test-responsible%29" class="tocviewlink" data-pltdoc="x">Responsible-<wbr></wbr>Party and Varying-<wbr></wbr>Output Logging</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">在本页中：</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">13.1<tt>&nbsp;</tt></span><a href="#%28part._test-config%29" class="tocsubseclink" data-pltdoc="x">Test Configuration by Submodule</a></td></tr><tr><td><span class="tocsublinknumber">13.2<tt>&nbsp;</tt></span><a href="#%28part._test-config-info%29" class="tocsubseclink" data-pltdoc="x">Test Configuration by <span class="stt">"info.rkt"</span></a></td></tr><tr><td><span class="tocsublinknumber">13.3<tt>&nbsp;</tt></span><a href="#%28part._test-responsible%29" class="tocsubseclink" data-pltdoc="x">Responsible-<wbr></wbr>Party and Varying-<wbr></wbr>Output Logging</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="…搜索手册…" title="输入搜索字符串以搜索手册" onkeypress="return DoSearchKey(event, this, &quot;7.0.0.18&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;…搜索手册…&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;…搜索手册…&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="上至文档的顶层" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.0.0.18&quot;);">&#39030;&#23618;</a></span><span class="navright">&nbsp;&nbsp;<a href="c-mods.html" title="后退至&quot;12.2 Embedding Modules via C&quot;" data-pltdoc="x">&larr; &#21069;&#19968;&#39029;</a>&nbsp;&nbsp;<a href="index.html" title="上至&quot;raco: Racket Command-Line Tools&quot;" data-pltdoc="x">&#19978;&#19968;&#23618;</a>&nbsp;&nbsp;<a href="docs.html" title="前进至&quot;14 raco docs: Documentation Search&quot;" data-pltdoc="x">&#21518;&#19968;&#39029; &rarr;</a></span>&nbsp;</div><h3 x-source-module="(lib &quot;scribblings/raco/raco.scrbl&quot;)" x-source-pkg="racket-doc" x-part-tag="&quot;test&quot;">13<tt>&nbsp;</tt><a name="(part._test)"></a><span class="stt">raco test</span>: Run tests</h3><p>The <span class="stt">raco test</span> command requires and runs the (by default)
<span class="RktSym">test</span> submodule associated with each path given on the command
line. Command-line flags can control which submodule is run, whether to
run the main module if no submodule is found, and whether to run tests
directly, in separate processes (the default), or in separate places.
The current directory is set to a test file&rsquo;s directory before running
the file.</p><p>When an argument path refers to a directory, <span class="stt">raco test</span>
recursively discovers and runs all files within the directory that end
in a module suffix (see <span class="RktSym"><a href="API_for_Raw_Compilation.html#%28def._%28%28lib._compiler%2Fmodule-suffix..rkt%29._get-module-suffixes%29%29" class="RktValLink" data-pltdoc="x">get-module-suffixes</a></span>, but the suffixes
always include <span class="stt">".rkt"</span>, <span class="stt">".scrbl"</span>, <span class="stt">".ss"</span>, and
<span class="stt">".scm"</span>) or have a (possibly empty) list of command-line arguments provided by
<span class="RktSym">test-command-line-arguments</span> in an <span class="stt">"info.rkt"</span> file,
or as directed by <span class="RktSym">test-include-paths</span> in an
<span class="stt">"info.rkt"</span> file.  At the same time, <span class="stt">raco test</span> omits
files and directories within a directory as directed by
<span class="RktSym">test-omit-paths</span> in an <span class="stt">"info.rkt"</span> file.</p><p>A test is counted as failing if it logs a failing test code via
<span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=rackunit&amp;rel=Testing_Utilities.html%23%2528def._%2528%2528lib._rackunit%252Flog..rkt%2529._test-log%2521%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">test-log!</a></span>, causes Racket to exit with a non-zero exit code, or
(when <span class="nobreak"><span class="stt">-e</span></span> or <span class="nobreak"><span class="stt">--check-stderr</span></span> is specified) if it produces
output on the error port.</p><p>The <span class="stt">raco test</span> command accepts several flags:</p><ul><li><p><span class="nobreak"><span class="stt">-c</span></span> or <span class="nobreak"><span class="stt">--collection</span></span>
&#8212;<wbr></wbr> Interprets the arguments as collections whose content
should be tested (in the same way as directory content).</p></li><li><p><span class="nobreak"><span class="stt">-p</span></span> or <span class="nobreak"><span class="stt">--package</span></span>
&#8212;<wbr></wbr> Interprets the arguments as packages whose contents should
be tested (in the same way as directory content). All package
scopes are searched for the first, most specific <a href="http://docs.racket-lang.org/local-redirect/index.html?doc=pkg&amp;rel=Package_Concepts.html%23%2528tech._package._scope%2529&amp;version=7.0.0.18" class="techoutside Sq" data-pltdoc="x"><span class="techinside">package scope</span></a>.</p></li><li><p><span class="nobreak"><span class="stt">-l</span></span> or <span class="nobreak"><span class="stt">--lib</span></span>
&#8212;<wbr></wbr> Interprets the arguments as libraries that should be tested.</p></li><li><p><span class="nobreak"><span class="stt">-m</span></span> or <span class="nobreak"><span class="stt">--modules</span></span>
&#8212;<wbr></wbr> Not only interprets the arguments as paths (which is the
default mode), but treats them the same as paths found in a
directory, which means ignoring a file argument that does not
have a module extension or is not enabled explicitly via
<span class="RktSym">test-command-line-arguments</span> or <span class="RktSym">test-include-paths</span>
in an <span class="stt">"info.rkt"</span> file; meanwhile, paths that are otherwise
enabled can be disabled via <span class="RktSym">test-omit-paths</span> in an
<span class="stt">"info.rkt"</span> file.</p></li><li><p><span class="nobreak"><span class="stt">--drdr</span></span>
&#8212;<wbr></wbr> Configures defaults to imitate the DrDr continuous testing
system: ignore non-modules, run tests in separate processes,
use as many jobs as available processors,
set the default timeout to 90 seconds,
create a fresh <span class="stt">PLTUSERHOME</span> and <span class="stt">TMPDIR</span> for each test,
count stderr output as a test failure,
quiet program output,
provide empty program input,
and print a table of results.</p></li><li><p><span class="nobreak"><span class="stt">-s</span></span> <span class="sroman">&#8249;<span style="font-family: 楷体">name</span>&#8250;</span> or <span class="nobreak"><span class="stt">--submodule</span></span> <span class="sroman">&#8249;<span style="font-family: 楷体">name</span>&#8250;</span>
&#8212;<wbr></wbr> Requires the submodule <span class="sroman">&#8249;<span style="font-family: 楷体">name</span>&#8250;</span> rather than <span class="RktSym">test</span>.
Supply <span class="nobreak"><span class="stt">-s</span></span> or <span class="nobreak"><span class="stt">--submodule</span></span> to run multiple submodules,
or combine multiple submodules with <span class="nobreak"><span class="stt">--first-avail</span></span> to
run the first available of the listed modules.</p></li><li><p><span class="nobreak"><span class="stt">-r</span></span> or <span class="nobreak"><span class="stt">--run-if-absent</span></span>
&#8212;<wbr></wbr> Requires the top-level module of a file if a relevant submodule is not
present. This is the default mode.</p></li><li><p><span class="nobreak"><span class="stt">-x</span></span> or <span class="nobreak"><span class="stt">--no-run-if-absent</span></span>
&#8212;<wbr></wbr> Ignores a file if the relevant submodule is not present.</p></li><li><p><span class="nobreak"><span class="stt">--first-avail</span></span>
&#8212;<wbr></wbr> When multiple submodule names are provided with <span class="nobreak"><span class="stt">-s</span></span> or
<span class="nobreak"><span class="stt">--submodule</span></span>, runs only the first available submodule.</p></li><li><p><span class="nobreak"><span class="stt">--configure-runtime</span></span>
 &#8212;<wbr></wbr> Run a <span class="RktSym">configure-runtime</span> submodule (if any) of
 each specified module before the module or a
 submodule is run. This mode is the default when only a single
 module is provided or when <span class="nobreak"><span class="stt">--process</span></span> or <span class="nobreak"><span class="stt">--place</span></span>
 mode is specified, unless a submodule name is provided
 via <span class="nobreak"><span class="stt">-s</span></span> or <span class="nobreak"><span class="stt">--submodule</span></span>.</p></li><li><p><span class="nobreak"><span class="stt">--direct</span></span>
&#8212;<wbr></wbr> Runs each test in a thread. This mode is the default if
a single file is specified. Multiple tests can interfere with
each other and the overall test run by exiting, unsafe operations
that block (and thus prevent timeout), and so on.</p></li><li><p><span class="nobreak"><span class="stt">--process</span></span>
&#8212;<wbr></wbr> Runs each test in a separate operating-system process. This
    mode is the default if multiple files are specified or if a
    directory, collection, or package is specified.</p></li><li><p><span class="nobreak"><span class="stt">--place</span></span>
&#8212;<wbr></wbr> Runs each test in a <a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=places.html%23%2528tech._place%2529&amp;version=7.0.0.18" class="techoutside Sq" data-pltdoc="x"><span class="techinside">place</span></a>, instead of in an
operating-system process.</p></li><li><p><span class="nobreak"><span class="stt">-j</span></span> <span class="sroman">&#8249;<span style="font-family: 楷体">n</span>&#8250;</span> or <span class="nobreak"><span class="stt">--jobs</span></span> <span class="sroman">&#8249;<span style="font-family: 楷体">n</span>&#8250;</span>
&#8212;<wbr></wbr> Runs up to <span class="sroman">&#8249;<span style="font-family: 楷体">n</span>&#8250;</span> tests in parallel.</p></li><li><p><span class="nobreak"><span class="stt">--timeout</span></span> <span class="sroman">&#8249;<span style="font-family: 楷体">seconds</span>&#8250;</span>
&#8212;<wbr></wbr> Sets the default timeout (after which a test counts as failed)
to <span class="sroman">&#8249;<span style="font-family: 楷体">seconds</span>&#8250;</span>. Use <span class="stt">+inf.0</span> to allow tests to run without
limit but allow <span class="RktSym">timeout</span> sub-submodule configuration.
If any test fails due to a timeout, the exit status of <span class="stt">raco test</span>
is 2 (as opposed to 1 for only non-timeout failures or 0 for success).</p></li><li><p><span class="nobreak"><span class="stt">--fresh-user</span></span>
&#8212;<wbr></wbr> When running tests in a separate process, creates a fresh
directory and sets <span class="stt">PLTUSERHOME</span> and <span class="stt">TMPDIR</span>. The
<span class="stt">PLTADDONDIR</span> environment variable is also set so that
the add-on directory (which is where packages are installed, for
example) does <span style="font-family: 楷体">not</span> change for each test process.</p></li><li><p><span class="nobreak"><span class="stt">--empty-stdin</span></span>
&#8212;<wbr></wbr> Provide an empty stdin to each test program.</p></li><li><p><span class="nobreak"><span class="stt">-Q</span></span> or <span class="nobreak"><span class="stt">--quiet-program</span></span>
&#8212;<wbr></wbr> Suppresses output from each test program.</p></li><li><p><span class="nobreak"><span class="stt">-e</span></span> or <span class="nobreak"><span class="stt">--check-stderr</span></span>
&#8212;<wbr></wbr> Count any stderr output as a test failure.</p></li><li><p><span class="nobreak"><span class="stt">--deps</span></span>
&#8212;<wbr></wbr> If considering arguments as packages, also check package
dependencies.</p></li><li><p><span class="nobreak"><span class="stt">++ignore-stderr</span></span> <span class="sroman">&#8249;<span style="font-family: 楷体">pattern</span>&#8250;</span>
&#8212;<wbr></wbr> Don&rsquo;t count stderr output as a test failure if it matches
<span class="sroman">&#8249;<span style="font-family: 楷体">pattern</span>&#8250;</span>.  This flag can be used multiple times, and
stderr output is treated as success as long as it matches any
one <span class="sroman">&#8249;<span style="font-family: 楷体">pattern</span>&#8250;</span>.</p></li><li><p><span class="nobreak"><span class="stt">-q</span></span> or <span class="nobreak"><span class="stt">--quiet</span></span>
&#8212;<wbr></wbr> Suppresses output of progress information, responsible
parties, and varying output (see <a href="#%28part._test-responsible%29" data-pltdoc="x">Responsible-Party and Varying-Output Logging</a>).</p></li><li><p><span class="nobreak"><span class="stt">--heartbeat</span></span>
&#8212;<wbr></wbr> Periodically report that a test is still running after
the test has been running at least 5 seconds.</p></li><li><p><span class="nobreak"><span class="stt">--table</span></span> or <span class="nobreak"><span class="stt">-t</span></span>
&#8212;<wbr></wbr> Print a summary table after all tests. If a test uses
<a href="http://docs.racket-lang.org/local-redirect/index.html?doc=rackunit&amp;rel=api.html&amp;version=7.0.0.18" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">rackunit</span></a>, or if a test at least uses
<span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=rackunit&amp;rel=Testing_Utilities.html%23%2528def._%2528%2528lib._rackunit%252Flog..rkt%2529._test-log%2521%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">test-log!</a></span> from <a href="http://docs.racket-lang.org/local-redirect/index.html?doc=rackunit&amp;rel=Testing_Utilities.html%23%2528mod-path._rackunit%252Flog%2529&amp;version=7.0.0.18" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">rackunit/log</span></a> to log
successes and failures, the table reports test and failure
counts based on the log.</p></li><li><p><span class="nobreak"><span class="stt">++arg</span></span> <span class="sroman">&#8249;<span style="font-family: 楷体">argument</span>&#8250;</span>
&#8212;<wbr></wbr> Adds <span class="sroman">&#8249;<span style="font-family: 楷体">argument</span>&#8250;</span> to the list of arguments to the invoked test module,
so that the invoked module sees <span class="sroman">&#8249;<span style="font-family: 楷体">argument</span>&#8250;</span> in its
<span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=runtime.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._current-command-line-arguments%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">current-command-line-arguments</a></span>. These arguments are
combined with any arguments specified in <span class="stt">"info.rkt"</span>
by <span class="RktSym">test-command-line-arguments</span>.</p></li><li><p><span class="nobreak"><span class="stt">++args</span></span> <span class="sroman">&#8249;<span style="font-family: 楷体">arguments</span>&#8250;</span>
 &#8212;<wbr></wbr> The same as <span class="nobreak"><span class="stt">++arg</span></span>, but <span class="sroman">&#8249;<span style="font-family: 楷体">arguments</span>&#8250;</span> is treated
 as a whitespace-delimited list of arguments to add. To specify
 multiple arguments using this flag within a typical shell,
 <span class="sroman">&#8249;<span style="font-family: 楷体">arguments</span>&#8250;</span> must be
 enclosed in quotation marks.</p></li></ul><p class="SHistory">&#20462;&#25913;&#20110;package <span class="stt">compiler-lib</span>&#30340;1.1&#29256;&#26412;&#65306;Added <span class="nobreak"><span class="stt">--heartbeat</span></span>.<br/>&#20462;&#25913;&#20110;1.4&#29256;&#26412;&#65306;Changed recognition of module suffixes to use <span class="RktSym"><a href="API_for_Raw_Compilation.html#%28def._%28%28lib._compiler%2Fmodule-suffix..rkt%29._get-module-suffixes%29%29" class="RktValLink" data-pltdoc="x">get-module-suffixes</a></span>,
which implies recognizing <span class="stt">".ss"</span> and <span class="stt">".rkt"</span>.<br/>&#20462;&#25913;&#20110;1.5&#29256;&#26412;&#65306;Added <span class="nobreak"><span class="stt">++ignore-stderr</span></span>.<br/>&#20462;&#25913;&#20110;1.6&#29256;&#26412;&#65306;Added <span class="nobreak"><span class="stt">++arg</span></span> and <span class="nobreak"><span class="stt">++args</span></span>.</p><h4 x-source-module="(lib &quot;scribblings/raco/raco.scrbl&quot;)" x-source-pkg="racket-doc" x-part-tag="&quot;test-config&quot;">13.1<tt>&nbsp;</tt><a name="(part._test-config)"></a>Test Configuration by Submodule</h4><p>When <span class="stt">raco test</span> runs a test in a submodule, a <span class="RktSym">config</span>
sub-submodule can provide additional configuration for running the
test. The <span class="RktSym">config</span> sub-submodule should use the
<a href="info_rkt.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">info</span></a> module language to define the following
identifiers:</p><ul><li><p><span class="RktSym">timeout</span> &#8212;<wbr></wbr> a real number to override the default
timeout for the test, which applies only when timeouts are
enabled.</p></li><li><p><span class="RktSym">responsible</span> &#8212;<wbr></wbr> a string, symbol, or list of symbols
and strings identifying a responsible party that should be
notified when the test fails. See <a href="#%28part._test-responsible%29" data-pltdoc="x">Responsible-Party and Varying-Output Logging</a>.</p></li><li><p><span class="RktSym">lock-name</span> &#8212;<wbr></wbr> a string that names a lock file that is
used to serialize tests (i.e., tests that have the same lock
name do not run concurrently). The lock file&rsquo;s location is
determined by the <span class="stt">PLTLOCKDIR</span> enviornment varible or
defaults to <span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=Filesystem.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._find-system-path%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">find-system-path</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">temp-dir</span><span class="RktPn">)</span>. The maximum
time to wait on the lock file is determined by the
<span class="stt">PLTLOCKTIME</span> environment variable or defaults to 4
hours.</p></li><li><p><span class="RktSym">ignore-stderr</span> &#8212;<wbr></wbr> a string, byte string, or
<a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=regexp.html%23%2528tech._regexp._value%2529&amp;version=7.0.0.18" class="techoutside Sq" data-pltdoc="x"><span class="techinside">regexp value</span></a>, as a pattern that
causes error output to not be treated as a failure if the
output matches the pattern.</p></li><li><p><span class="RktSym">random?</span> &#8212;<wbr></wbr> if true, indicates that the test&rsquo;s output
is expected to vary. See <a href="#%28part._test-responsible%29" data-pltdoc="x">Responsible-Party and Varying-Output Logging</a>.</p></li></ul><p>In order to prevent evaluation of a file for testing purposes, it
suffices to create a submodule that does not perform any tests and
does not trigger the evaluation of the enclosing module. So, for
instance, a file might look like this:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=guide&amp;rel=Module_Syntax.html%23%2528part._hash-lang%2529&amp;version=7.0.0.18" class="RktModLink Sq" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="hspace">&nbsp;</span><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=index.html&amp;version=7.0.0.18" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">racket</span></a></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%252F%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">don</span><span class="RktCmt">'</span><span class="RktCmt">t run this file for testing:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=module.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._module%2529%2529&amp;version=7.0.0.18" class="RktStxLink Sq" data-pltdoc="x">module</a></span><span class="hspace">&nbsp;</span><span class="RktSym">test</span><span class="hspace">&nbsp;</span><span class="RktSym">racket/base</span><span class="RktPn">)</span></td></tr></table></blockquote><p class="SHistory">&#20462;&#25913;&#20110;package <span class="stt">compiler-lib</span>&#30340;1.5&#29256;&#26412;&#65306;Added <span class="RktSym">ignore-stderr</span> support.</p><h4 x-source-module="(lib &quot;scribblings/raco/raco.scrbl&quot;)" x-source-pkg="racket-doc" x-part-tag="&quot;test-config-info&quot;">13.2<tt>&nbsp;</tt><a name="(part._test-config-info)"></a>Test Configuration by <span class="stt">"info.rkt"</span></h4><p>Submodule-based test configuration is preferred (see
<a href="#%28part._test-config%29" data-pltdoc="x">Test Configuration by Submodule</a>). In particular, to prevent <span class="stt">raco test</span>
from running a particular file, normally the file should contain a
submodule that takes no action.</p><p>In some cases, however, adding a submodule is inconvenient or
impossible (e.g., because the file will not always compile). Thus,
<span class="stt">raco test</span> also consults any <span class="stt">"info.rkt"</span> file in the
candidate test file&rsquo;s directory. In the case of a file within a
collection, <span class="stt">"info.rkt"</span> files from any enclosing collection
directories are also consulted for <span class="RktSym">test-omit-paths</span> and
<span class="RktSym">test-include-paths</span>. Finally, for a file within a package, the
package&rsquo;s <span class="stt">"info.rkt"</span> is consulted for <span class="RktSym">pkg-authors</span> to
set the default responsible parties (see <a href="#%28part._test-responsible%29" data-pltdoc="x">Responsible-Party and Varying-Output Logging</a>)
for all files in the package.</p><p>The following <span class="stt">"info.rkt"</span> fields are recognized:</p><ul><li><p><span class="RktSym">test-omit-paths</span> &#8212;<wbr></wbr> a list of path strings (relative
to the enclosing directory) and regexp values (to omit all
files within the enclosing directory matching the expression),
or <span class="RktVal">'</span><span class="RktVal">all</span> to omit all files within the enclosing directory.
When a path string refers to a directory, all files within the
directory are omitted.</p></li><li><p><span class="RktSym">test-include-paths</span> &#8212;<wbr></wbr> a list of path strings (relative
to the enclosing directory) and regexp values (to include all
files within the enclosing directory matching the expression),
or <span class="RktVal">'</span><span class="RktVal">all</span> to include all files within the enclosing directory.
When a path string refers to a directory, all files within the
directory are included.</p></li><li><p><span class="RktSym">test-command-line-arguments</span> &#8212;<wbr></wbr> a list of
<span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVar">module-path-string</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVar">argument-path-string</span><span class="stt"> </span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=7.0.0.18" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span>, where <span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=runtime.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._current-command-line-arguments%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">current-command-line-arguments</a></span> is set to
a vector that contains the <span class="RktVar">argument-path-string</span> when
running <span class="RktVar">module-path-string</span>.</p></li><li><p><span class="RktSym">test-timeouts</span> &#8212;<wbr></wbr> a list of <span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVar">module-path-string</span><span class="stt"> </span><span class="RktVar">real-number</span><span class="RktPn">)</span> to override the default
timeout for <span class="RktVar">module-path-string</span>.</p></li><li><p><span class="RktSym">test-responsibles</span> &#8212;<wbr></wbr> a list of <span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVar">module-path-string</span><span class="stt"> </span><span class="RktVar">party</span><span class="RktPn">)</span> or <span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">all</span><span class="stt"> </span><span class="RktVar">party</span><span class="RktPn">)</span> to
override the default responsible party for
<span class="RktVar">module-path-string</span> or all files within the directory
(except as overridden), respectively. Each <span class="RktVar">party</span> is a
string, symbol, or list of symbols and strings. See
<a href="#%28part._test-responsible%29" data-pltdoc="x">Responsible-Party and Varying-Output Logging</a>.</p></li><li><p><span class="RktSym">test-lock-names</span> &#8212;<wbr></wbr> a list of <span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVar">module-path-string</span><span class="stt"> </span><span class="RktVar">lock-string</span><span class="RktPn">)</span> to declare a lock file name
for <span class="RktVar">module-path-string</span>. See <span class="RktSym">lock-name</span> in
<a href="#%28part._test-config%29" data-pltdoc="x">Test Configuration by Submodule</a>.</p></li><li><p><span class="RktSym">test-ignore-stderrs</span> &#8212;<wbr></wbr> a list of <span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVar">module-path-string</span><span class="stt"> </span><span class="RktVar">pattern</span><span class="RktPn">)</span> or <span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=7.0.0.18" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">all</span><span class="stt"> </span><span class="RktVar">pattern</span><span class="RktPn">)</span>
to declare patterns of standard error output that are allowed a
non-failures for <span class="RktVar">module-path-string</span> or all files
within the directory. Each <span class="RktVar">pattern</span> must be a string,
byte string, or <a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=regexp.html%23%2528tech._regexp._value%2529&amp;version=7.0.0.18" class="techoutside Sq" data-pltdoc="x"><span class="techinside">regexp value</span></a>. See
<span class="RktSym">ignore-stderr</span> in <a href="#%28part._test-config%29" data-pltdoc="x">Test Configuration by Submodule</a>.</p></li><li><p><span class="RktSym">test-randoms</span> &#8212;<wbr></wbr> a list of path strings (relative to
the enclosing directory) for modules whose output varies.
See <a href="#%28part._test-responsible%29" data-pltdoc="x">Responsible-Party and Varying-Output Logging</a>.</p></li><li><p><span class="RktSym">module-suffixes</span> and <span class="RktSym">doc-module-suffixes</span> &#8212;<wbr></wbr>
Used indirectly via <span class="RktSym"><a href="API_for_Raw_Compilation.html#%28def._%28%28lib._compiler%2Fmodule-suffix..rkt%29._get-module-suffixes%29%29" class="RktValLink" data-pltdoc="x">get-module-suffixes</a></span>.</p></li></ul><p class="SHistory">&#20462;&#25913;&#20110;package <span class="stt">compiler-lib</span>&#30340;1.5&#29256;&#26412;&#65306;Added <span class="RktSym">test-ignore-stderrs</span> support.</p><h4 x-source-module="(lib &quot;scribblings/raco/raco.scrbl&quot;)" x-source-pkg="racket-doc" x-part-tag="&quot;test-responsible&quot;">13.3<tt>&nbsp;</tt><a name="(part._test-responsible)"></a>Responsible-Party and Varying-Output Logging</h4><p>When a test has a declared responsible party, then the test&rsquo;s output
is prefixed with a</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">raco test:</span><span class="sroman">&#8249;<span style="font-family: 楷体">which</span>&#8250;</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">@(test-responsible '</span><span class="sroman">&#8249;<span style="font-family: 楷体">responsible</span>&#8250;</span><span class="stt">)</span></p></td></tr></table></p><p>line, where <span class="sroman">&#8249;<span style="font-family: 楷体">which</span>&#8250;</span> is a space followed by an exact
non-negative number indicating a parallel task when parallelism is
enabled (or empty otherwise), and <span class="sroman">&#8249;<span style="font-family: 楷体">responsible</span>&#8250;</span> is a string,
symbol, or list datum.</p><p>When a test&rsquo;s output (as written to stdout) is expected to vary across
runs&#8212;<wbr></wbr>aside from varying output that has the same form as produced by
<span class="RktSym"><a href="http://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=time.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fmore-scheme..rkt%2529._time%2529%2529&amp;version=7.0.0.18" class="RktStxLink Sq" data-pltdoc="x">time</a></span>&#8212;<wbr></wbr>then it should be declared as varying. In that case,
the test&rsquo;s output is prefixed with a</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">raco test:</span><span class="sroman">&#8249;<span style="font-family: 楷体">which</span>&#8250;</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">@(test-random #t)</span></p></td></tr></table></p><p>line.</p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="…搜索手册…" title="输入搜索字符串以搜索手册" onkeypress="return DoSearchKey(event, this, &quot;7.0.0.18&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;…搜索手册…&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;…搜索手册…&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="上至文档的顶层" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.0.0.18&quot;);">&#39030;&#23618;</a></span><span class="navright">&nbsp;&nbsp;<a href="c-mods.html" title="后退至&quot;12.2 Embedding Modules via C&quot;" data-pltdoc="x">&larr; &#21069;&#19968;&#39029;</a>&nbsp;&nbsp;<a href="index.html" title="上至&quot;raco: Racket Command-Line Tools&quot;" data-pltdoc="x">&#19978;&#19968;&#23618;</a>&nbsp;&nbsp;<a href="docs.html" title="前进至&quot;14 raco docs: Documentation Search&quot;" data-pltdoc="x">&#21518;&#19968;&#39029; &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>